<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="melody5417">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="melody5417">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="melody5417">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always","offset":15,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> melody5417 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">melody5417</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">åšè®©è‡ªå·±ä½©æœçš„äººï½</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/13/ios-OSX-crash/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/13/ios-OSX-crash/" itemprop="url">
                  ios/OSX crash
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-06-13T11:21:37+08:00">
                2017-06-13
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/06/13/ios-OSX-crash/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/13/ios-OSX-crash/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æœ€è¿‘åœ¨é›†ä¸­å¤„ç†é¡¹ç›®çš„crashï¼Œè§‰å¾—æœ‰å¿…è¦å°†è§£å†³crashçš„æ€è·¯æ•´ç†æ€»ç»“ã€‚<br>å…ˆä¸Šè„‘å›¾ï¼š</p>
<p><img src="https://raw.githubusercontent.com/melody5417/blogResources/master/iOS%3AOS%20X%20crash.png" alt="crash mindnode"></p>
<p>å…ˆå ä½ï¼Œåç»­è¡¥å……è¯¦ç»†ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/01/Learn-Synchronization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/01/Learn-Synchronization/" itemprop="url">
                  Learn Synchronization
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-06-01T23:40:11+08:00">
                2017-06-01
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/06/01/Learn-Synchronization/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/01/Learn-Synchronization/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>OS X å’Œ iOS çš„å¤šçº¿ç¨‹å®‰å…¨å¼€å‘ä¸€ç›´éƒ½å®¹æ˜“æˆä¸º App å¼€å‘çš„å‘ï¼Œå¤„ç†ä¸å¥½å°±å®¹æ˜“å‡ºç° crash æˆ–å„ç§å„æ ·å¥‡æ€ªçš„ç°è±¡ï¼Œè¿™æ¬¡ä¸‹å®šå†³å¿ƒæ·±å…¥ç ”ç©¶ã€Œå¤šçº¿ç¨‹å¼€å‘ä¸­çš„åŒæ­¥å·¥å…·ã€ã€‚<a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Multithreading/ThreadSafety/ThreadSafety.html" target="_blank" rel="external">è‹¹æœå®˜æ–¹èµ„æ–™</a> <a href="https://github.com/melody5417/LearnSynchronization.git" target="_blank" rel="external">æœ¬æ–‡Demo</a></p>
<h2 id="Synchronization-Tools"><a href="#Synchronization-Tools" class="headerlink" title="Synchronization Tools"></a>Synchronization Tools</h2><p>åŒæ­¥å·¥å…·åŒ…æ‹¬ï¼š</p>
<ul>
<li>Atomic Operations</li>
<li>Memory Barriers and Volatile Variables</li>
<li>Locks</li>
<li>Conditions</li>
<li>Perform Selector Routines</li>
</ul>
<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦ç ”ç©¶ Locks å’Œ Conditionsã€‚</p>
<h2 id="Tips-for-Thread-Safe-Designs"><a href="#Tips-for-Thread-Safe-Designs" class="headerlink" title="Tips for Thread-Safe Designs"></a>Tips for Thread-Safe Designs</h2><h3 id="Avoid-Synchronization-Altogether"><a href="#Avoid-Synchronization-Altogether" class="headerlink" title="Avoid Synchronization Altogether"></a>Avoid Synchronization Altogether</h3><p>ä½¿ç”¨é”ä¸€å®šä¼šå¯¹æ€§èƒ½å’Œå“åº”é€Ÿåº¦æœ‰å½±å“ï¼Œæ‰€ä»¥å°½é‡è§£è€¦è®¾è®¡ï¼Œå‡å°‘äº¤äº’å’Œä¾èµ–çš„æ¨¡å—ï¼Œä»è€Œå‡å°‘é”çš„ä½¿ç”¨ã€‚</p>
<h3 id="Be-Aware-of-Threats-to-Code-Correctness"><a href="#Be-Aware-of-Threats-to-Code-Correctness" class="headerlink" title="Be Aware of Threats to Code Correctness"></a>Be Aware of Threats to Code Correctness</h3><p>çœ‹ä¸‹é¢çš„ğŸŒ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">NSLock* arrayLock = GetArrayLock();</div><div class="line">NSMutableArray* myArray = GetSharedArray();</div><div class="line">id anObject;</div><div class="line"> </div><div class="line">[arrayLock lock];</div><div class="line">anObject = [myArray objectAtIndex:0];</div><div class="line">[arrayLock unlock];</div><div class="line"> </div><div class="line">[anObject doSomething];</div></pre></td></tr></table></figure>
<p>arrayæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥åœ¨ä¿®æ”¹arrayçš„æ—¶å€™åŠ äº†é”ã€‚ä½†æ˜¯doSomthingæ–¹æ³•æ²¡æœ‰åŠ é”ï¼Œè¿™é‡Œå°±ä¼šå‡ºç°é—®é¢˜ï¼šå¦‚æœåœ¨ unlock ä¹‹åï¼Œæœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ¸…ç©ºäº†arrayï¼Œarrayä¸­çš„å¯¹è±¡è¢«é‡Šæ”¾ï¼Œæ­¤æ—¶anObjectæŒ‡å‘çš„æ˜¯éåˆæ³•çš„å†…å­˜åœ°å€ï¼Œåœ¨è°ƒç”¨doSomethingæ–¹æ³•å°±ä¼šå‡ºç°é—®é¢˜ã€‚</p>
<p>ä¸ºäº†è§£å†³é—®é¢˜ï¼Œå¯èƒ½ä¼šç§»åŠ¨doSomethingçš„é¡ºåºï¼Œå°†å…¶ç§»å…¥é”å†…ä¿æŠ¤ã€‚ä½†æ˜¯ï¼Œæ­¤æ—¶åˆå¯èƒ½å‡ºç°å¦ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœdoSomethingæ˜¯ä¸€ä¸ªè€—æ—¶å¾ˆé•¿çš„æ–¹æ³•ï¼Œé‚£å°±ä¼šä¸€ç›´ç­‰å¾…ï¼Œæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚</p>
<p>è§£å†³è¿™ä¸ªé—®é¢˜çš„æ ¹æœ¬åœ¨äº â€œa memory management issue that is triggered only by the presence of other threads. Because it can be released by another thread, a better solution would be to retain anObject before releasing the lock. This solution addresses the real problem of the object being released and does so without introducing a potential performance penalty.â€</p>
<p>ä¿®æ­£åçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">NSLock* arrayLock = GetArrayLock();</div><div class="line">NSMutableArray* myArray = GetSharedArray();</div><div class="line">id anObject;</div><div class="line"> </div><div class="line">[arrayLock lock];</div><div class="line">anObject = [myArray objectAtIndex:0];</div><div class="line">[anObject retain];</div><div class="line">[arrayLock unlock];</div><div class="line"> </div><div class="line">[anObject doSomething];</div><div class="line">[anObject release];</div></pre></td></tr></table></figure>
<p>æ›´å¤š <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Multithreading/ThreadSafetySummary/ThreadSafetySummary.html#//apple_ref/doc/uid/10000057i-CH12-SW1" target="_blank" rel="external">å®˜æ–¹tips</a></p>
<h3 id="Watch-Out-for-Deadlocks-and-Livelocks"><a href="#Watch-Out-for-Deadlocks-and-Livelocks" class="headerlink" title="Watch Out for Deadlocks and Livelocks"></a>Watch Out for Deadlocks and Livelocks</h3><p><a href="http://www.cnblogs.com/ktgu/p/3529143.html" target="_blank" rel="external">æ­»é”å’Œæ´»é”çš„è§£é‡Š</a></p>
<p>å…³äºâ€œæ­»é”ä¸æ´»é”â€çš„æ¯”å–»ï¼š<br>æ­»é”ï¼šè¿é¢å¼€æ¥çš„æ±½è½¦Aå’Œæ±½è½¦Bè¿‡é©¬è·¯ï¼Œæ±½è½¦Aå¾—åˆ°äº†åŠæ¡è·¯çš„èµ„æºï¼ˆæ»¡è¶³æ­»é”å‘ç”Ÿæ¡ä»¶1ï¼šèµ„æºè®¿é—®æ˜¯æ’ä»–æ€§çš„ï¼Œæˆ‘å äº†è·¯ä½ å°±ä¸èƒ½ä¸Šæ¥ï¼Œé™¤éä½ çˆ¬æˆ‘å¤´ä¸Šå»ï¼‰ï¼Œæ±½è½¦Bå äº†æ±½è½¦Açš„å¦å¤–åŠæ¡è·¯çš„èµ„æºï¼ŒAæƒ³è¿‡å»å¿…é¡»è¯·æ±‚å¦ä¸€åŠè¢«Bå ç”¨çš„é“è·¯ï¼ˆæ­»é”å‘ç”Ÿæ¡ä»¶2ï¼šå¿…é¡»æ•´æ¡è½¦èº«çš„ç©ºé—´æ‰èƒ½å¼€è¿‡å»ï¼Œæˆ‘å·²ç»å äº†ä¸€åŠï¼Œå°¼ç›å¦ä¸€åŠçš„è·¯è¢«Bå ç”¨äº†ï¼‰ï¼ŒBè‹¥æƒ³è¿‡å»ä¹Ÿå¿…é¡»ç­‰å¾…Aè®©è·¯ï¼ŒAæ˜¯è¾†å…°åšåŸºå°¼ï¼ŒBæ˜¯å¼€å¥‡ç‘QQçš„å±Œä¸ï¼ŒAç´ è´¨æ¯”è¾ƒä½å¼€çª—å¯¹Bç‹‚éª‚ï¼šå¿«ç»™è€å­è®©å¼€ï¼ŒBå¾ˆç”Ÿæ°”ï¼Œä½ å¦ˆé€¼çš„ï¼Œè€å­å°±ä¸è®©ï¼ˆæ­»é”å‘ç”Ÿæ¡ä»¶3ï¼šåœ¨æœªä½¿ç”¨å®Œèµ„æºå‰ï¼Œä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å‰¥å¤ºï¼‰ï¼Œäºæ˜¯ä¸¤è€…ç›¸äº’åƒµæŒä¸€ä¸ªéƒ½èµ°ä¸äº†ï¼ˆæ­»é”å‘ç”Ÿæ¡ä»¶4ï¼šç¯è·¯ç­‰å¾…æ¡ä»¶ï¼‰ï¼Œè€Œä¸”å¯¼è‡´æ•´æ¡é“ä¸Šçš„åç»­è½¦è¾†ä¹Ÿèµ°ä¸äº†ã€‚</p>
<p>æ´»é”ï¼šé©¬è·¯ä¸­é—´æœ‰æ¡å°æ¡¥ï¼Œåªèƒ½å®¹çº³ä¸€è¾†è½¦ç»è¿‡ï¼Œæ¡¥ä¸¤å¤´å¼€æ¥ä¸¤è¾†è½¦Aå’ŒBï¼ŒAæ¯”è¾ƒç¤¼è²Œï¼Œç¤ºæ„Bå…ˆè¿‡ï¼ŒBä¹Ÿæ¯”è¾ƒç¤¼è²Œï¼Œç¤ºæ„Aå…ˆè¿‡ï¼Œç»“æœä¸¤äººä¸€ç›´è°¦è®©è°ä¹Ÿè¿‡ä¸å»ã€‚</p>
<p>The best way to avoid both deadlock and livelock situations is to take only one lock at a time. If you must acquire more than one lock at a time, you should make sure that other threads do not try to do something similar.</p>
<h2 id="Using-Locks"><a href="#Using-Locks" class="headerlink" title="Using Locks"></a>Using Locks</h2><h3 id="Using-a-POSIX-Mutex-Lock"><a href="#Using-a-POSIX-Mutex-Lock" class="headerlink" title="Using a POSIX Mutex Lock"></a>Using a POSIX Mutex Lock</h3><p>POSIX mutex lock æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;</div><div class="line">int pthread_mutex_init(pthread_mutex_t *mutex, </div><div class="line">    const pthread_mutexattr_t *attr);</div><div class="line">int pthread_mutex_destroy(pthread_mutex_t *mutex);</div><div class="line">int pthread_mutex_lock(pthread_mutex_t *mutex);</div><div class="line">int pthread_mutex_trylock(pthread_mutex_t *mutex);</div><div class="line">int pthread_mutex_unlock(pthread_mutex_t *mutex);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">TestObj *obj = [[TestObj alloc] init];</div><div class="line"></div><div class="line">   // åˆ›å»ºé”å¯¹è±¡</div><div class="line">   __block pthread_mutex_t mutex;</div><div class="line">   pthread_mutex_init(&amp;mutex, NULL);</div><div class="line"></div><div class="line">   // çº¿ç¨‹1</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       pthread_mutex_lock(&amp;mutex);</div><div class="line">       [obj method1];</div><div class="line">       sleep(5);</div><div class="line">       pthread_mutex_unlock(&amp;mutex);</div><div class="line">   &#125;);</div><div class="line"></div><div class="line">   // çº¿ç¨‹2</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       pthread_mutex_lock(&amp;mutex);</div><div class="line">       [obj method2];</div><div class="line">       sleep(5);</div><div class="line">       pthread_mutex_unlock(&amp;mutex);</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<h3 id="Using-the-NSLock-Class"><a href="#Using-the-NSLock-Class" class="headerlink" title="Using the NSLock Class"></a>Using the NSLock Class</h3><p>æ‰€æœ‰é”å®é™…éƒ½æ˜¯å®ç°äº† NSLocking åè®®ï¼Œå®šä¹‰äº† lock å’Œ unlock æ–¹æ³•ã€‚<br>NSLock ç±»ä½¿ç”¨çš„æ˜¯ POSIX æ¥å®ç°å®ƒçš„é”æ“ä½œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¿…é¡»åœ¨åŒä¸€çº¿ç¨‹å†…å‘é€ unlock æ¶ˆæ¯ï¼Œå¦åˆ™ä¼šå‘ç”Ÿä¸ç¡®å®šçš„æƒ…å†µã€‚NSLock ä¸èƒ½ç”¨æ¥å®ç°è¿­ä»£é”ï¼Œå› ä¸ºå¦‚æœå‘ç”Ÿä¸¤æ¬¡ lock æ¶ˆæ¯çš„è¯ï¼Œæ•´ä¸ªçº¿ç¨‹ä¼šè¢«æ°¸ä¹…é”ä½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">TestObj *obj = [[TestObj alloc] init];</div><div class="line">   NSLock *lock = [[NSLock alloc] init];</div><div class="line"></div><div class="line">   // çº¿ç¨‹1</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       [lock lock];</div><div class="line">       NSLog(@&quot;çº¿ç¨‹1 lock&quot;);</div><div class="line">       [obj method1];</div><div class="line">       sleep(2);</div><div class="line">       [lock unlock];</div><div class="line">       NSLog(@&quot;çº¿ç¨‹1 unLock&quot;);</div><div class="line">   &#125;);</div><div class="line"></div><div class="line">   // çº¿ç¨‹2</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       // å…ˆ sleep ä»¥ä¿è¯çº¿ç¨‹2çš„ä»£ç åæ‰§è¡Œ</div><div class="line">       sleep(1);</div><div class="line">       [lock lock];</div><div class="line">       NSLog(@&quot;çº¿ç¨‹2 lock&quot;);</div><div class="line">       [obj method2];</div><div class="line">       [lock unlock];</div><div class="line">       NSLog(@&quot;çº¿ç¨‹2 unLock&quot;);</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<h3 id="Using-the-synchronized-Directive"><a href="#Using-the-synchronized-Directive" class="headerlink" title="Using the @synchronized Directive"></a>Using the @synchronized Directive</h3><p>ä½œä¸ºä¸€ç§é¢„é˜²æªæ–½ï¼Œ@synchronizedå—éšå¼çš„æ·»åŠ ä¸€ä¸ªå¼‚å¸¸å¤„ç†ä¾‹ç¨‹æ¥ä¿æŠ¤ä»£ç ã€‚è¯¥å¤„ç†ä¾‹ç¨‹ä¼šåœ¨å¼‚å¸¸æŠ›å‡ºçš„æ—¶å€™è‡ªåŠ¨çš„é‡Šæ”¾äº’æ–¥é”ã€‚è¿™æ„å‘³ç€ä¸ºäº†ä½¿ç”¨@synchronizedæŒ‡ä»¤ï¼Œä½ å¿…é¡»åœ¨ä½ çš„ä»£ç ä¸­å¯ç”¨å¼‚å¸¸å¤„ç†ã€‚å¦‚æœä½ ä¸æƒ³è®©éšå¼çš„å¼‚å¸¸å¤„ç†ä¾‹ç¨‹å¸¦æ¥é¢å¤–çš„å¼€é”€ï¼Œä½ åº”è¯¥è€ƒè™‘ä½¿ç”¨é”çš„ç±»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">TestObj *obj = [[TestObj alloc] init];</div><div class="line"></div><div class="line">   // çº¿ç¨‹1</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       @synchronized (obj) &#123;</div><div class="line">           [obj method1];</div><div class="line">           sleep(10);</div><div class="line">       &#125;</div><div class="line">   &#125;);</div><div class="line"></div><div class="line">   // çº¿ç¨‹2</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       sleep(1);</div><div class="line">       @synchronized (obj) &#123;</div><div class="line">           [obj method2];</div><div class="line">       &#125;</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<h3 id="Using-an-NSRecursiveLock-Object"><a href="#Using-an-NSRecursiveLock-Object" class="headerlink" title="Using an NSRecursiveLock Object"></a>Using an NSRecursiveLock Object</h3><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸ªğŸŒ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">//ä¸»çº¿ç¨‹ä¸­</div><div class="line">   NSLock *theLock = [[NSLock alloc] init];</div><div class="line">   TestObj *obj = [[TestObj alloc] init];</div><div class="line"></div><div class="line">   //çº¿ç¨‹1</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       static void(^TestMethod)(int);</div><div class="line">       TestMethod = ^(int value)</div><div class="line">       &#123;</div><div class="line">           [theLock lock];</div><div class="line">           if (value &gt; 0)</div><div class="line">           &#123;</div><div class="line">               [obj method1];</div><div class="line">               sleep(5);</div><div class="line">               TestMethod(value-1);</div><div class="line">           &#125;</div><div class="line">           [theLock unlock];</div><div class="line">       &#125;;</div><div class="line">       TestMethod(5);</div><div class="line">   &#125;);</div><div class="line"></div><div class="line">   //çº¿ç¨‹2</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       sleep(1);</div><div class="line">       [theLock lock];</div><div class="line">       [obj method2];</div><div class="line">       [theLock unlock];</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<p>è¿è¡Œè¿™æ®µä»£ç ï¼Œä¼šå‘ç°æŠ¥é”™ï¼Œå‘ç”Ÿæ­»é”ï¼š</p>
<pre><code>2017-05-31 11:54:01.467100+0800 LearnLockIniOSMultiThreading[1863:602383] method1
2017-05-31 11:54:06.471439+0800 LearnLockIniOSMultiThreading[1863:602383] *** -[NSLock lock]: deadlock (&lt;NSLock: 0x6180000c1340&gt; &apos;(null)&apos;)
2017-05-31 11:54:06.471478+0800 LearnLockIniOSMultiThreading[1863:602383] *** Break on _NSLockError() to debug.
</code></pre><p>è¿™é‡Œå°±æ˜¯ä¹‹å‰è¯´çš„ï¼ŒNSLock ä¸èƒ½ç”¨æ¥å®ç°è¿­ä»£é”ï¼Œå› ä¸ºå¦‚æœå‘ç”Ÿä¸¤æ¬¡ lock æ¶ˆæ¯çš„è¯ï¼Œæ•´ä¸ªçº¿ç¨‹ä¼šè¢«æ°¸ä¹…é”ä½ã€‚è¿™æ—¶å°±åº”è¯¥ä½¿ç”¨ NSRecursiveLockã€‚</p>
<p>NSRecursiveLockç±»å®šä¹‰äº†å¯ä»¥è¢«åŒä¸€çº¿ç¨‹è·å–å¤šæ¬¡è€Œä¸ä¼šé€ æˆæ­»é”çš„é”ã€‚NSRecursiveLockå¯ä»¥è¢«ç”¨åœ¨é€’å½’è°ƒç”¨ä¸­ï¼Œä¸€ä¸ªé€’å½’é”ä¼šè·Ÿè¸ªå®ƒè¢«å¤šå°‘æ¬¡æˆåŠŸè·å¾—äº†ã€‚æ¯æ¬¡æˆåŠŸçš„è·å¾—è¯¥é”éƒ½å¿…é¡»å¹³è¡¡è°ƒç”¨é”ä½å’Œè§£é”çš„æ“ä½œã€‚åªæœ‰æ‰€æœ‰çš„é”ä½å’Œè§£é”æ“ä½œéƒ½å¹³è¡¡çš„æ—¶å€™ï¼Œé”æ‰çœŸæ­£è¢«é‡Šæ”¾ç»™å…¶ä»–çº¿ç¨‹è·å¾—ã€‚è¿™ç§ç±»å‹çš„é”é€šå¸¸è¢«ç”¨åœ¨ä¸€ä¸ªé€’å½’å‡½æ•°é‡Œé¢æ¥é˜²æ­¢é€’å½’é€ æˆé˜»å¡çº¿ç¨‹ï¼Œåªæœ‰å½“å¤šæ¬¡è·å–çš„é”å…¨éƒ¨é‡Šæ”¾æ—¶ï¼ŒNSRecursiveLockæ‰èƒ½è¢«å…¶ä»–çº¿ç¨‹è·å–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">//ä¸»çº¿ç¨‹ä¸­</div><div class="line">    NSRecursiveLock *theLock = [[NSRecursiveLock alloc] init];</div><div class="line">    TestObj *obj = [[TestObj alloc] init];</div><div class="line"></div><div class="line">    //çº¿ç¨‹1</div><div class="line">    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">        static void(^TestMethod)(int);</div><div class="line">        TestMethod = ^(int value)</div><div class="line">        &#123;</div><div class="line">            [theLock lock];</div><div class="line">            if (value &gt; 0)</div><div class="line">            &#123;</div><div class="line">                [obj method1];</div><div class="line">                sleep(5);</div><div class="line">                TestMethod(value-1);</div><div class="line">            &#125;</div><div class="line">            [theLock unlock];</div><div class="line">        &#125;;</div><div class="line">        TestMethod(5);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    //çº¿ç¨‹2</div><div class="line">    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">        sleep(1);</div><div class="line">        [theLock lock];</div><div class="line">        [obj method2];</div><div class="line">        [theLock unlock];</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>å› ä¸ºä¸€ä¸ªé€’å½’é”ä¸ä¼šè¢«é‡Šæ”¾ç›´åˆ°æ‰€æœ‰é”çš„è°ƒç”¨å¹³è¡¡ä½¿ç”¨äº†è§£é”æ“ä½œï¼Œæ‰€ä»¥ä½ å¿…é¡»ä»”ç»†æƒè¡¡æ˜¯å¦å†³å®šä½¿ç”¨é”å¯¹æ€§èƒ½çš„æ½œåœ¨å½±å“ã€‚é•¿æ—¶é—´æŒæœ‰ä¸€ä¸ªé”å°†ä¼šå¯¼è‡´å…¶ä»–çº¿ç¨‹é˜»å¡ç›´åˆ°é€’å½’å®Œæˆã€‚å¦‚æœä½ å¯ä»¥é‡å†™ä½ çš„ä»£ç æ¥æ¶ˆé™¤é€’å½’æˆ–æ¶ˆé™¤ä½¿ç”¨ä¸€ä¸ªé€’å½’é”ï¼Œä½ å¯èƒ½ä¼šè·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</p>
<h3 id="Using-an-NSConditionLock-Object"><a href="#Using-an-NSConditionLock-Object" class="headerlink" title="Using an NSConditionLock Object"></a>Using an NSConditionLock Object</h3><p>NSConditionLockå®šä¹‰äº†ä¸€ä¸ªæ¡ä»¶äº’æ–¥é”ï¼Œä¹Ÿå°±æ˜¯å½“æ¡ä»¶æˆç«‹æ—¶å°±ä¼šè·å–åˆ°é”ï¼Œåä¹‹å°±ä¼šé‡Šæ”¾é”ã€‚å®ƒçš„è¡Œä¸ºå’ŒCoditionæœ‰ç‚¹ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒä»¬çš„å®ç°éå¸¸ä¸åŒã€‚å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼Œæ¡ä»¶é”å¯ä»¥è¢«ç”¨åœ¨æœ‰ç‰¹å®šé¡ºåºçš„å¤„ç†æµç¨‹ä¸­ï¼Œå½“å¤šçº¿ç¨‹éœ€è¦ä»¥ç‰¹å®šçš„é¡ºåºæ¥æ‰§è¡Œä»»åŠ¡çš„æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªNSConditionLockå¯¹è±¡ï¼Œæ¯”å¦‚ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ã€‚</p>
<p>NSConditionLockçš„é”ä½å’Œè§£é”æ–¹æ³•å¯ä»¥ä»»æ„ç»„åˆä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨unlockWithCondition:å’Œlockæ¶ˆæ¯ï¼Œæˆ–ä½¿ç”¨lockWhenCondition:å’Œunlockæ¶ˆæ¯ã€‚å½“ç„¶ï¼Œåé¢çš„ç»„åˆå¯ä»¥è§£é”ä¸€ä¸ªé”ä½†æ˜¯å¯èƒ½æ²¡æœ‰é‡Šæ”¾ä»»ä½•ç­‰å¾…æŸç‰¹å®šæ¡ä»¶å€¼çš„çº¿ç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">NSConditionLock *lock = [[NSConditionLock alloc] init];</div><div class="line"></div><div class="line">   // çº¿ç¨‹1</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       for (int i = 0; i &lt;= 2; i++) &#123;</div><div class="line">           [lock lock];</div><div class="line">           NSLog(@&quot;thread1:%d&quot;, i);</div><div class="line">           sleep(2);</div><div class="line">           [lock unlockWithCondition:i];</div><div class="line">       &#125;</div><div class="line">   &#125;);</div><div class="line"></div><div class="line">   // çº¿ç¨‹2</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       [lock lockWhenCondition:2];</div><div class="line">       NSLog(@&quot;thread2&quot;);</div><div class="line">       [lock unlock];</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<h3 id="Using-an-NSDistributedLock-Object"><a href="#Using-an-NSDistributedLock-Object" class="headerlink" title="Using an NSDistributedLock Object"></a>Using an NSDistributedLock Object</h3><p>NSDistributedLockæ˜¯è·¨è¿›ç¨‹çš„åˆ†å¸ƒå¼é”ï¼Œé”æœ¬èº«æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„äº’æ–¥é”ï¼Œåº•å±‚æ˜¯ç”¨æ–‡ä»¶ç³»ç»Ÿå®ç°çš„äº’æ–¥é”ã€‚å¦‚æœPathä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨tryLockè¿”å›YESæ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºpathã€‚åœ¨ç»“æŸçš„æ—¶å€™Pathä¼šè¢«æ¸…é™¤ï¼Œæ‰€ä»¥åœ¨é€‰æ‹©pathçš„æ—¶å€™ï¼Œåº”è¯¥é€‰æ‹©ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„ï¼Œä»¥é˜²æ­¢è¯¯æ“ä½œã€‚</p>
<p>NSDistributedLockæ²¡æœ‰å®ç°NSLockingåè®®ï¼Œæ‰€ä»¥æ²¡æœ‰ä¼šé˜»å¡çº¿ç¨‹çš„lockæ–¹æ³•ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯éé˜»å¡çš„tryLockæ–¹æ³•ã€‚NSDistributedLockç±»å¯ä»¥è¢«å¤šå°ä¸»æœºä¸Šçš„å¤šä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨æ¥é™åˆ¶å¯¹æŸäº›å…±äº«èµ„æºçš„è®¿é—®ã€‚å¯¹äºä¸€ä¸ªå¯ç”¨çš„NSDistributedLockå¯¹è±¡ï¼Œé”å¿…é¡»ç”±æ‰€æœ‰ä½¿ç”¨å®ƒçš„ç¨‹åºå†™å…¥ã€‚</p>
<p>NSDistributedLockåªæœ‰åœ¨é”æŒæœ‰è€…æ˜¾å¼åœ°é‡Šæ”¾åæ‰ä¼šè¢«é‡Šæ”¾ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æŒæœ‰é”çš„åº”ç”¨å´©æºƒåï¼Œå…¶ä»–åº”ç”¨å°±ä¸èƒ½è®¿é—®å—ä¿æŠ¤çš„å…±äº«èµ„æºäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨breadLockæ–¹æ³•æ¥æ‰“ç ´ç°å­˜çš„é”ä»¥ä¾¿ä½ å¯ä»¥è·å–å®ƒã€‚ä½†æ˜¯é€šå¸¸åº”è¯¥é¿å…æ‰“ç ´é”ï¼Œé™¤éä½ ç¡®å®šæ‹¥æœ‰è¿›ç¨‹å·²ç»æ­»äº¡å¹¶ä¸å¯èƒ½å†é‡Šæ”¾è¯¥é”ã€‚å’Œå…¶ä»–ç±»å‹çš„é”ä¸€æ ·ï¼Œå½“ä½ ä½¿ç”¨NSDistributedLockå¯¹è±¡æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨unlockæ–¹æ³•æ¥é‡Šæ”¾å®ƒã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">appAçš„ä»£ç ï¼š</div><div class="line">	dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">        NSString *desktopPath = NSSearchPathForDirectoriesInDomains(NSDesktopDirectory, NSUserDomainMask, YES).firstObject;</div><div class="line">        NSDistributedLock *lock = [[NSDistributedLock alloc] initWithPath:[desktopPath stringByAppendingPathComponent:@&quot;testDistributedLock__&quot;]];</div><div class="line"></div><div class="line">        [lock breakLock];</div><div class="line">        [lock tryLock];</div><div class="line">        sleep(10);</div><div class="line">        [lock unlock];</div><div class="line">        NSLog(@&quot;appA OK&quot;);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">appBçš„ä»£ç ï¼š</div><div class="line">	dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">        NSString *desktopPath = NSSearchPathForDirectoriesInDomains(NSDesktopDirectory, NSUserDomainMask, YES).firstObject;</div><div class="line">        NSDistributedLock *lock = [[NSDistributedLock alloc] initWithPath:[desktopPath stringByAppendingPathComponent:@&quot;testDistributedLock__&quot;]];</div><div class="line"></div><div class="line">        while (![lock tryLock]) &#123;</div><div class="line">            NSLog(@&quot;appB waiting&quot;);</div><div class="line">            sleep(1);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        [lock unlock];</div><div class="line">        NSLog(@&quot;appB OK&quot;);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>è¾“å‡ºå¦‚å›¾ï¼š<img src="https://raw.githubusercontent.com/melody5417/LearnSynchronization/master/TestDistributedLock.png" alt="DistributedLock"></p>
<h3 id="Using-the-NSCondition-Class"><a href="#Using-the-NSCondition-Class" class="headerlink" title="Using the NSCondition Class"></a>Using the NSCondition Class</h3><p>NSCondition æ˜¯äº’æ–¥é”å’Œæ¡ä»¶é”çš„ç»“åˆä½“ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…ä¿¡å·è€Œé˜»å¡æ—¶ï¼Œå¯ä»¥è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹å”¤é†’ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæ“ä½œç³»ç»Ÿå®ç°çš„å·®å¼‚ï¼Œå³ä½¿åœ¨ä»£ç ä¸­æ²¡æœ‰å‘é€signalæ¶ˆæ¯ï¼Œçº¿ç¨‹ä¹Ÿæœ‰å¯èƒ½è¢«å”¤é†’ï¼Œæ‰€ä»¥éœ€è¦å¢åŠ è°“è¯å˜é‡æ¥ä¿è¯ç¨‹åºçš„æ­£ç¡®æ€§ã€‚</p>
<ul>
<li>waitï¼šé‡Šæ”¾äº’æ–¥é‡ï¼Œä½¿å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œåˆ‡æ¢åˆ°å…¶å®ƒçº¿ç¨‹æ‰§è¡Œã€‚</li>
<li>waitUntilDateï¼šé‡Šæ”¾äº’æ–¥é‡ï¼Œä½¿å½“å‰çº¿ç¨‹ç­‰å¾…åˆ°æŸä¸€ä¸ªæ—¶é—´ï¼Œåˆ‡æ¢åˆ°å…¶å®ƒçº¿ç¨‹æ‰§è¡Œã€‚</li>
<li>signalï¼šå”¤é†’ä¸€ä¸ªå…¶å®ƒç­‰å¾…è¯¥æ¡ä»¶å˜é‡çš„çº¿ç¨‹</li>
<li>broadcastï¼šå”¤é†’æ‰€æœ‰å…¶å®ƒç­‰å¾…è¯¥æ¡ä»¶å˜é‡çš„çº¿ç¨‹</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">NSCondition *condition = [[NSCondition alloc] init];</div><div class="line">   NSMutableArray *products = [[NSMutableArray alloc] init];</div><div class="line"></div><div class="line">   // çº¿ç¨‹1</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       NSLog(@&quot;çº¿ç¨‹1:before lock&quot;);</div><div class="line">       [condition lock];</div><div class="line">       NSLog(@&quot;çº¿ç¨‹1:after lock&quot;);</div><div class="line"></div><div class="line">       while ([products count] == 0) &#123;</div><div class="line">           NSLog(@&quot;çº¿ç¨‹1:wait&quot;);</div><div class="line">           [condition wait];</div><div class="line">       &#125;</div><div class="line">       [products removeAllObjects];</div><div class="line">       NSLog(@&quot;çº¿ç¨‹1:remove&quot;);</div><div class="line">       [condition unlock];</div><div class="line">   &#125;);</div><div class="line"></div><div class="line">   // çº¿ç¨‹2</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       sleep(1);</div><div class="line">       NSLog(@&quot;çº¿ç¨‹2: before lock&quot;);</div><div class="line">       [condition lock];</div><div class="line">       NSLog(@&quot;çº¿ç¨‹2: after lock&quot;);</div><div class="line">       [products addObject:[NSObject new]];</div><div class="line">       [condition signal];</div><div class="line">       NSLog(@&quot;çº¿ç¨‹2 signal&quot;);</div><div class="line">       [condition unlock];</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<h3 id="Using-POSIX-Conditions"><a href="#Using-POSIX-Conditions" class="headerlink" title="Using POSIX Conditions"></a>Using POSIX Conditions</h3><p>POSIX çº¿ç¨‹æ¡ä»¶é”éœ€è¦æ¡ä»¶é”å’Œäº’æ–¥é”é…åˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">__block pthread_cond_t condition;</div><div class="line">   pthread_cond_init(&amp;condition, NULL);</div><div class="line"></div><div class="line">   __block pthread_mutex_t mutex;</div><div class="line">   pthread_mutex_init(&amp;mutex, NULL);</div><div class="line"></div><div class="line">   __block Boolean ready_to_go = false;</div><div class="line"></div><div class="line">   // çº¿ç¨‹1</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       NSLog(@&quot;çº¿ç¨‹1:before lock&quot;);</div><div class="line">       pthread_mutex_lock(&amp;mutex);</div><div class="line">       NSLog(@&quot;çº¿ç¨‹1:after lock&quot;);</div><div class="line"></div><div class="line">       while (ready_to_go == false) &#123;</div><div class="line">           NSLog(@&quot;çº¿ç¨‹1:wait&quot;);</div><div class="line">           pthread_cond_wait(&amp;condition, &amp;mutex);</div><div class="line">       &#125;</div><div class="line">       // Do work. (The mutex should stay locked.)</div><div class="line"></div><div class="line">       // Reset the predicate and release the mutex.</div><div class="line">       ready_to_go = false;</div><div class="line">       NSLog(@&quot;çº¿ç¨‹1:reset predicate&quot;);</div><div class="line">       pthread_mutex_unlock(&amp;mutex);</div><div class="line">   &#125;);</div><div class="line"></div><div class="line">   // çº¿ç¨‹2</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       sleep(1);</div><div class="line">       NSLog(@&quot;çº¿ç¨‹2: before lock&quot;);</div><div class="line">       pthread_mutex_lock(&amp;mutex);</div><div class="line">       NSLog(@&quot;çº¿ç¨‹2: after lock&quot;);</div><div class="line">       ready_to_go = true;</div><div class="line">       pthread_cond_signal(&amp;condition);</div><div class="line">       NSLog(@&quot;çº¿ç¨‹2 signal the other thread to begin work&quot;);</div><div class="line">       pthread_mutex_unlock(&amp;mutex);</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<h3 id="Using-GCD-dispatch-sempaphore"><a href="#Using-GCD-dispatch-sempaphore" class="headerlink" title="Using GCD dispatch_sempaphore"></a>Using GCD dispatch_sempaphore</h3><p>dispatch_sempaphore æ˜¯ GCD ç”¨æ¥åŒæ­¥çš„ä¸€ç§æ–¹å¼ï¼Œå®ƒä¸»è¦æœ‰ä¸¤ä¸ªåº”ç”¨ï¼š ä¿æŒçº¿ç¨‹åŒæ­¥ å’Œ ä¸ºçº¿ç¨‹åŠ é”ã€‚æä¾›ä»¥ä¸‹æ–¹æ³•ï¼šï¼ˆ<a href="http://www.jianshu.com/p/a84c2bf0d77b" target="_blank" rel="external">å‚è€ƒ</a>ï¼‰</p>
<ul>
<li>dispatch_semaphore_t dispatch_semaphore_create(long value)ï¼šæ–¹æ³•æ¥æ”¶ä¸€ä¸ªlongç±»å‹çš„å‚æ•°, è¿”å›ä¸€ä¸ªdispatch_semaphore_tç±»å‹çš„ä¿¡å·é‡ï¼Œå€¼ä¸ºä¼ å…¥çš„å‚æ•°</li>
<li>long dispatch_semaphore_wait(dispatch_semaphore_t dsema, dispatch_time_t timeout)ï¼šæ¥æ”¶ä¸€ä¸ªä¿¡å·å’Œæ—¶é—´å€¼ï¼Œè‹¥ä¿¡å·çš„ä¿¡å·é‡ä¸º0ï¼Œåˆ™ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°ä¿¡å·é‡å¤§äº0æˆ–è€…ç»è¿‡è¾“å…¥çš„æ—¶é—´å€¼ï¼›è‹¥ä¿¡å·é‡å¤§äº0ï¼Œåˆ™ä¼šä½¿ä¿¡å·é‡å‡1å¹¶è¿”å›ï¼Œç¨‹åºç»§ç»­ä½ä¸‹æ‰§è¡Œ</li>
<li>long dispatch_semaphore_signal(dispatch_semaphore_t dsema)ï¼šä½¿ä¿¡å·é‡åŠ 1å¹¶è¿”å›</li>
</ul>
<h4 id="ä¿æŒçº¿ç¨‹åŒæ­¥"><a href="#ä¿æŒçº¿ç¨‹åŒæ­¥" class="headerlink" title="ä¿æŒçº¿ç¨‹åŒæ­¥"></a>ä¿æŒçº¿ç¨‹åŒæ­¥</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">dispatch_queue_t queue = dispatch_get_global_queue(0, 0);</div><div class="line">   dispatch_semaphore_t semaphore = dispatch_semaphore_create(0);</div><div class="line"></div><div class="line">   __block int j = 0;</div><div class="line">   dispatch_async(queue, ^&#123;</div><div class="line">       j = 100;</div><div class="line">       dispatch_semaphore_signal(semaphore);</div><div class="line">   &#125;);</div><div class="line"></div><div class="line">   dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);</div><div class="line">   NSLog(@&quot;finish j = %zd&quot;, j);</div></pre></td></tr></table></figure>
<p>è¿è¡Œä»£ç ï¼Œè¾“å‡º j=100ã€‚ å¦‚æœæ³¨é‡Šæ‰ wait è¿™å¥ï¼Œåˆ™è¾“å‡º j=0ã€‚<br>åŸå› ï¼šblock æ˜¯å¼‚æ­¥æ·»åŠ åˆ°å¹¶è¡Œé˜Ÿåˆ— queue é‡Œï¼Œæ‰€ä»¥ä¸»çº¿ç¨‹æ˜¯è¶Šè¿‡ block ç›´æ¥åˆ° dispatch_semaphore_wait è¿™ä¸€è¡Œï¼Œæ­¤æ—¶ï¼Œsemaphore ä¿¡å·é‡ä¸º0ï¼Œæ—¶é—´å€¼ä¸º Foreverï¼Œæ‰€ä»¥ä¸€å®šä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œblockåˆ°å¼‚æ­¥å¹¶è¡Œé˜Ÿåˆ—æ‰§è¡Œï¼Œå‘é€signalï¼Œä½¿ä¿¡å·é‡+1ï¼Œæ­¤æ—¶ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œèµ·åˆ°äº†åŒæ­¥çš„æ•ˆæœã€‚</p>
<h4 id="ä¸ºçº¿ç¨‹åŠ é”"><a href="#ä¸ºçº¿ç¨‹åŠ é”" class="headerlink" title="ä¸ºçº¿ç¨‹åŠ é”"></a>ä¸ºçº¿ç¨‹åŠ é”</h4><p>å½“ semaphore ä¿¡å·é‡ä¸º1æ—¶,å¯ä»¥ç”¨äºåŠ é”ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">TestObj *obj = [[TestObj alloc] init];</div><div class="line">   dispatch_semaphore_t semaphore = dispatch_semaphore_create(1);</div><div class="line"></div><div class="line">   // çº¿ç¨‹1</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);</div><div class="line">       [obj method1];</div><div class="line">       sleep(10);</div><div class="line">       dispatch_semaphore_signal(semaphore);</div><div class="line">   &#125;);</div><div class="line"></div><div class="line">   //çº¿ç¨‹2</div><div class="line">   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">       sleep(1);</div><div class="line">       dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);</div><div class="line">       [obj method2];</div><div class="line">       dispatch_semaphore_signal(semaphore);</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<h3 id="Using-OSSpinLock"><a href="#Using-OSSpinLock" class="headerlink" title="Using OSSpinLock"></a>Using OSSpinLock</h3><p>å…ˆå£°æ˜ä¸€ä¸‹ï¼ŒOSSpinLock åœ¨iOS10 å’Œ macOS 10.12å·²ç»è¢«åºŸå¼ƒï¼Œ è‹¹æœç»™å‡ºäº†æ›¿ä»£æ–¹æ¡ˆ os_unfair_lockã€‚<a href="https://gist.github.com/steipete/36350a8a60693d440954b95ea6cbbafc" target="_blank" rel="external">å‚è€ƒ</a></p>
<p>ç°åœ¨æ¥å­¦ä¹ ä¸€ä¸‹OSSpinLockï¼Œä¸»è¦æä¾›ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<ul>
<li>typedef int32_t OSSpinLock;</li>
<li>bool    OSSpinLockTry( volatile OSSpinLock *__lock );</li>
<li>void    OSSpinLockLock( volatile OSSpinLock *__lock );</li>
<li>void    OSSpinLockUnlock( volatile OSSpinLock *__lock );</li>
</ul>
<p>OSSpinLockæ˜¯ä¸€ç§è‡ªæ—‹é”ï¼Œå’Œ NSLock ä¸åŒçš„æ˜¯ NSLock è¯·æ±‚åŠ é”å¤±è´¥çš„è¯ï¼Œä¼šå…ˆè½®è¯¢ï¼Œä½†ä¸€ç§’è¿‡åä¾¿ä¼šä½¿çº¿ç¨‹è¿›å…¥ waiting çŠ¶æ€ï¼Œç­‰å¾…å”¤é†’ã€‚è€Œ OSSpinLock ä¼šä¸€ç›´è½®è¯¢ï¼Œç­‰å¾…æ—¶ä¼šæ¶ˆè€—å¤§é‡ CPU èµ„æºï¼Œä¸é€‚ç”¨äºè¾ƒé•¿æ—¶é—´çš„ä»»åŠ¡ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/25/New-To-iOS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/25/New-To-iOS/" itemprop="url">
                  New To iOS
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-05-25T21:06:37+08:00">
                2017-05-25
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/25/New-To-iOS/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/25/New-To-iOS/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä»èŒç”Ÿæƒ³æ³•ï¼Œåˆ°é¼“èµ·å‹‡æ°”é¢è¯•ï¼Œè¹‰è·åŠå¹´ç»ˆäºæˆè¡Œã€‚<br>èµ°å‡ºèˆ’é€‚åŒºï¼Œæ‹¥æŠ±å˜åŒ–ï¼Œä¸ºæ–°çš„æŒ‘æˆ˜åšå‡†å¤‡ï¼Œ æ„¿ä¸€åˆ‡éƒ½å¥½ï½</p>
<h2 id="Introduce"><a href="#Introduce" class="headerlink" title="Introduce?"></a>Introduce?</h2><p>ä»Šå¤©ç»ˆäºç¡®å®šäº†å¯ä»¥è½¬ä½œiOSï¼Œæ²¡æœ‰é¢„æƒ³çš„é‚£ä¹ˆå¼€å¿ƒï¼Œæœ‰äº›å‹åŠ›ã€‚è‡ªå·±å»å¹´çš„è€ƒæ ¸è¿˜æ˜¯æ£’æ£’å“’ï¼Œä¸çŸ¥é“è½¬BGåï¼Œä¸ŠåŠå¹´çš„è€ƒæ ¸ä¼šå˜æˆå•¥æ ·ï¼Œæ„Ÿè§‰ä¼šæˆèƒŒé”…ä¾ ï¼Œå‘œå‘œï¼Œäººå®¶ä¸æƒ³å½“èƒŒé”…ä¾ (:/cry)</p>
<p>ä½†æ˜¯ä¸çœ‹moneyï¼ˆä¸çœ‹moneyï¼Œçœ‹å•¥(:/æŠ é¼»)ï¼‰ï¼Œçœ‹æœªæ¥çš„å‘å±•ï¼Œè§‰å¾—è‡ªå·±æ˜¯å¯¹çš„ï¼Œæ˜¯æ˜æ™ºçš„ï¼Œåšä¿¡ä¸èƒ½åœ¨è¯¥æ‹¼æå­¦ä¹ çš„å¹´çºªå®‰é€¸åº¦æ—¥ï¼</p>
<p>ä»Šå¤©ç‹ ä¸‹å¿ƒæ³¨å†Œäº†è‹¹æœçš„å¼€å‘è€…è´¦å·ï¼ŒæƒŠå¥‡çš„å‘ç°è‹¹æœå˜å–„è‰¯äº†ï¼Œå¼€å‘è€…è´¦å·å±…ç„¶è‹¹æœå…¨å¹³å°å¯ç”¨äº†ï¼Œç¬é—´æ„Ÿè§‰99åˆ€èŠ±çš„å€¼äº†ï½ ä¸ºäº†è®©è‡ªå·±æ›´æœ‰åŠ¨åŠ›ï¼Œå’Œç”·æœ‹å‹æ‰“äº†ä¸ª1000è½¯å¦¹å¸çš„èµŒæ³¨ï¼Œ2017å¹´ä¸€å®šè¦æäº¤ä¸€ä¸ªä½œå“ï¼ï¼ï¼</p>
<p>å†™äº†ä¸ªå°ç¨‹åº <a href="https://github.com/melody5417/PitchPerfect.git" target="_blank" rel="external">Pitch Perfect</a>ï¼Œç¬¬ä¸€æ¬¡ç”¨å¼€å‘è€…è´¦å·åœ¨çœŸæœºè¿è¡Œï¼Œè®°å½•ä¸€ä¸‹é‡åˆ°çš„é—®é¢˜ã€‚</p>
<h2 id="Prepare"><a href="#Prepare" class="headerlink" title="Prepare"></a>Prepare</h2><h3 id="add-device-to-Apple-ID-devices"><a href="#add-device-to-Apple-ID-devices" class="headerlink" title="add device to Apple ID devices"></a>add device to Apple ID devices</h3><p>Xcode7 ä¹‹åçœŸæœºè°ƒè¯•ä¹Ÿä¸ç”¨è¯ä¹¦äº†ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯åŠ äº†ä¸‹ï¼Œå­¦ä¹ ä¸‹æµç¨‹ã€‚<br>itunes ä¸­æŸ¥çœ‹æ‰‹æœºçš„ UDIDï¼Œç„¶åç™»é™† Apple çš„ Member Centerï¼Œæ·»åŠ è®¾å¤‡çš„ UDIDã€‚</p>
<h2 id="Create-Project"><a href="#Create-Project" class="headerlink" title="Create Project"></a>Create Project</h2><h3 id="process-symbol-files"><a href="#process-symbol-files" class="headerlink" title="process symbol files"></a>process symbol files</h3><p>åˆ›å»ºå·¥ç¨‹åè¿è¡Œï¼Œå¼¹å‡ºæç¤ºï¼šprocess symbol files.<br>google äº†ä¸‹è¿™ä¸ªé˜¶æ®µï¼ŒXcodeåˆ°åº•åœ¨åšä»€ä¹ˆï¼Œä»¥ä¸‹æ¥è‡ª <a href="https://stackoverflow.com/questions/19187857/processing-symbol-files-in-xcode" target="_blank" rel="external">stack overFlow</a></p>
<p>It downloads the (debug) symbols from the device, so it becomes possible to debug on devices with that specific iOS version and also to symbolicate crash reports that happened on that iOS version.</p>
<p>Since symbols are CPU specific, the above only works if you have imported the symbols not only for a specific iOS device but also for a specific CPU type. The currently CPU types needed are armv7 (e.g. iPhone 4, iPhone 4s), armv7s (e.g. iPhone 5) and arm64 (e.g. iPhone 5s).</p>
<p>So if you want to symbolicate a crash report that happened on an iPhone 5 with armv7s and only have the symbols for armv7 for that specific iOS version, Xcode wonâ€™t be able to (fully) symbolicate the crash report.</p>
<p>after â€œProcessing Symbol Filesâ€, a folder containing symbols associated with the device (including iOS version and CPU type) was created in ~/Library/Developer/Xcode/iOS DeviceSupport/ like this: <img src="https://raw.githubusercontent.com/melody5417/blogResources/master/direcotyToSymbol.jpg" alt="dirctory to Symbol"></p>
<h3 id="couldnâ€™t-launch"><a href="#couldnâ€™t-launch" class="headerlink" title="couldnâ€™t launch"></a>couldnâ€™t launch</h3><p>è¿æ¥ä¸Šè®¾å¤‡åï¼Œåº”ç”¨ä»ç„¶æ— æ³•è¿è¡Œï¼Œå¼¹å‡ºæç¤ºï¼š<img src="https://raw.githubusercontent.com/melody5417/blogResources/master/trustDeveloper.jpg" alt=""></p>
<p>æ­¤æ—¶å°±æŒ‰æç¤ºåšï¼Œè§£é”è®¾å¤‡ï¼Œæ‰“å¼€ è®¾ç½®-&gt;é€šç”¨-&gt;è®¾å¤‡ç®¡ç†-&gt;å¼€å‘è€…åº”ç”¨ï¼Œç„¶åä¿¡ä»»å¼€å‘è€…ï¼Œå†éªŒè¯åº”ç”¨ã€‚</p>
<p>NOTEï¼šè¿™é‡Œtrustæ“ä½œå¿…é¡»è”ç½‘æ‰å¯å®Œæˆï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚<br>å…³äºè”ç½‘éªŒè¯é—®é¢˜ï¼ŒæŸ¥äº†<a href="https://support.apple.com/en-ca/HT204460" target="_blank" rel="external">Appleçš„å®˜æ–¹æ–‡æ¡£</a>:</p>
<p>You must be connected to the Internet to verify the app developerâ€™s certificate when establishing trust.<br>If youâ€™re behind a firewall, make sure that itâ€™s configured to allow connections to <a href="https://ppq.apple.com" target="_blank" rel="external">https://ppq.apple.com</a>.<br>If you arenâ€™t connected to the Internet when you trust an app, the device displays â€œNot Verifiedâ€ instead.<br>To use the app, connect to the Internet and tap the Verify App button.</p>
<p>å…³äºè”ç½‘éªŒè¯ stack overflow è¿˜æœ‰ä¸€äº›å…¶ä»–æ–¹æ³•ç»•è¿‡ï¼Œå…·ä½“ä¸å†ç»†ç©¶ã€‚</p>
<h3 id="OS-Activity-Mode"><a href="#OS-Activity-Mode" class="headerlink" title="OS_Activity_Mode"></a>OS_Activity_Mode</h3><p>æƒ³è¦çœŸæœºè¿è¡ŒçœŸæ˜¯ç£¨éš¾é‡é‡ï¼Œåˆä¸€æ‹¦è·¯è™ï¼š<br>if weâ€™re in the real pre-commit handler we canâ€™t actually add any new fences due to CA restriction.</p>
<p>è¿™ä¸ªé—®é¢˜å°±æ˜¯æ·»åŠ ç¯å¢ƒå˜é‡ OS_Activity_Mode å¹¶ç½® disable.</p>
<h2 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h2><p>PitchPerfect åº”ç”¨æ˜¯å½•åˆ¶å£°éŸ³å¹¶è¿›è¡ŒéŸ³é«˜é€Ÿç‡çš„å˜åŒ–çš„å°åº”ç”¨ï¼Œéœ€è¦è®¿é—®éº¦å…‹é£ã€‚çœŸæœºè·‘èµ·æ¥ï¼Œç‚¹å‡»å½•åˆ¶ï¼Œéšå³ crashï¼ŒæŠ¥é”™ï¼š</p>
<p>This app has crashed because it attempted to access privacy-sensitive data without a usage description.<br>The appâ€™s Info.plist must contain an NSPhotoLibraryUsageDescription key with a string value explaining to the user how the app uses this data.</p>
<p>æŒ‰ç…§é”™è¯¯æŒ‡å¼•ï¼Œåœ¨ Info.plist ä¸­æ·»åŠ äº†Key: NSPhotoLibraryUsageDescriptionã€‚å…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;!-- éº¦å…‹é£ --&gt; </div><div class="line">&lt;key&gt;NSMicrophoneUsageDescription&lt;/key&gt; </div><div class="line">&lt;string&gt;Appéœ€è¦æ‚¨çš„åŒæ„,æ‰èƒ½è®¿é—®éº¦å…‹é£&lt;/string&gt;</div></pre></td></tr></table></figure>
<p>æè¿°å­—ç¬¦ä¸²è‡ªå·±éšæ„å¡«å†™å°±å¯ä»¥,ä½†æ˜¯ä¸€å®šè¦å¡«å†™ï¼Œä¸ç„¶ä¼šå¼•å‘åŒ…æ— æ•ˆçš„é—®é¢˜ï¼Œå¯¼è‡´ä¸Šä¼ æ‰“åŒ…åæ„å»ºç‰ˆæœ¬ä¸€ç›´ä¸æ˜¾ç¤ºã€‚</p>
<h2 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h2><p>å°±åƒå¼€ç¯‡å†™çš„ä¸€æ ·ï¼Œæ‹¥æŠ±å˜åŒ–ï¼Œè¿æ¥æŒ‘æˆ˜ï¼ŒHack On ~</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/23/ç¨‹åºå®‰å…¨å¼€å‘/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/23/ç¨‹åºå®‰å…¨å¼€å‘/" itemprop="url">
                  ç¨‹åºå®‰å…¨å¼€å‘
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-05-23T09:48:16+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/23/ç¨‹åºå®‰å…¨å¼€å‘/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/23/ç¨‹åºå®‰å…¨å¼€å‘/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æ˜¨å¤©å¬äº†ã€Œç¨‹åºå®‰å…¨å¼€å‘ã€è¿™é—¨è¯¾ï¼Œå¯¹ä»Šåé¡¹ç›®å¼€å‘æœ‰å¾ˆå¤§çš„è­¦ç¤ºä½œç”¨ï¼Œè¿™é‡Œå…ˆåšä¸ªè„‘å›¾æ•´ç†ï¼Œä¹‹åæ…¢æ…¢è¡¥å……ã€‚</p>
<p><img src="https://raw.githubusercontent.com/melody5417/blogResources/master/ç¨‹åºå®‰å…¨å¼€å‘.png" alt="æˆ‘æ˜¯è„‘å›¾"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/17/OS X animations/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/17/OS X animations/" itemprop="url">
                  OS X animations
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-05-17T18:44:52+08:00">
                2017-05-17
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/17/OS X animations/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/17/OS X animations/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æ–°é¡¹ç›®åšä¸€ä¸ªèƒŒæ™¯æ¸å˜ï¼ŒåŒæ—¶å›¾ç‰‡ç¼©æ”¾çš„åŠ¨ç”»ï¼Œåœ¨è®¾è®¡è€æ¿çš„ç”µè„‘ä¸Šå¡çš„å‰å®³ï¼Œæ‰€ä»¥å±•å¼€äº†ä¸€ç³»åˆ—å¯¹åŠ¨ç”»çš„ç ”ç©¶ã€‚</p>
<p>å…ˆä¸Šè„‘å›¾ï¼š<br><img src="https://raw.githubusercontent.com/melody5417/blogResources/master/OS%20X%20animations.png" alt="è„‘å›¾"></p>
<p>  ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ˜¯ä¸æ¨èä½¿ç”¨ NSAnimationContextï¼Œå®ƒæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸æ–­è°ƒç”¨ setFrame: å’Œ setFrameSize: ç­‰å®ç°çš„ç§»åŠ¨å’Œç¼©æ”¾åŠ¨ç”»ï¼Œæ˜¾ç„¶æ•ˆç‡ä½ä¸‹ã€‚åŒæ—¶æˆ‘çš„å›¾ç‰‡åˆæ˜¯é‡‡ç”¨ç¦»å±æ¸²æŸ“çš„ï¼Œæ‰€ä»¥æ€§èƒ½æ›´åŠ ä¸å¥½ã€‚</p>
<p>  ç»è¿‡è¿™å‡ ç¯‡æ–‡ç« çš„å­¦ä¹ ï¼Œæœ€ç»ˆé‡‡ç”¨ä»¥ä¸‹æ­¥éª¤ä¼˜åŒ–ï¼š</p>
<ol>
<li>é‡‡ç”¨layer-based çš„ CoreAnimationã€‚</li>
<li>ä¼˜åŒ–é‡ç»˜ç­–ç•¥ï¼šNSView çš„property è®¾ç½®ä¸º NSViewLayerContentsRedrawOnSetNeedsDisplay</li>
<li>å›¾ç‰‡å±•ç¤ºä¸å†ç”¨ NSImageViewï¼Œ ç›´æ¥è®¾ç½®ä¸º layer çš„ contentsã€‚</li>
</ol>
<p>æœ€ç»ˆå®ç°æ•ˆæœè€æ¿ç»ˆäºæ»¡æ„å•¦ï¼Œåšçš„ <a href="https://github.com/melody5417/Animation/tree/master" target="_blank" rel="external">Demo</a>ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/16/Create-Mac-memory-pressure-observer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/16/Create-Mac-memory-pressure-observer/" itemprop="url">
                  Create Mac memory pressure observer
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-05-16T12:01:52+08:00">
                2017-05-16
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/16/Create-Mac-memory-pressure-observer/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/16/Create-Mac-memory-pressure-observer/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Macçš„èµ„æ–™çœŸå¿ƒå°‘ï¼Œå…ˆæ¥çœ‹çœ‹iOSæ˜¯æ€ä¹ˆåšçš„ã€‚</p>
<h2 id="memory-pressure-observer-on-iOS"><a href="#memory-pressure-observer-on-iOS" class="headerlink" title="memory pressure observer on iOS"></a>memory pressure observer on iOS</h2><h3 id="how-to-observe"><a href="#how-to-observe" class="headerlink" title="how to observe"></a>how to observe</h3><ul>
<li>å¯ä»¥ç›‘å¬ UIApplicationDidReceiveMemoryWarningNotification é€šçŸ¥ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[[NSNotificationCenter defaultCenter] addObserver:self</div><div class="line">selector:@selector(XXX)</div><div class="line">name:UIApplicationDidReceiveMemoryWarningNotification </div><div class="line">object:nil];</div></pre></td></tr></table></figure>
<ul>
<li>å®ç° UIViewController è‡ªèº«çš„æ–¹æ³•didReceiveMemoryWarningï¼Œè¯¥æ–¹æ³•åœ¨ App æ¥æ”¶åˆ° memory warning ä¼šè¢«è°ƒç”¨ï¼Œå¯ä»¥åœ¨æ–¹æ³•ä¸­é‡Šæ”¾å½“å‰ä¸å†ä½¿ç”¨çš„èµ„æºã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (void)didReceiveMemoryWarning;</div></pre></td></tr></table></figure>
<h3 id="how-to-mock"><a href="#how-to-mock" class="headerlink" title="how to mock"></a>how to mock</h3><ul>
<li><p>æ¨¡æ‹Ÿå™¨èœå•<br>hardware -&gt; simulate memory warning</p>
</li>
<li><p>æ¨¡æ‹Ÿå‘é€šçŸ¥ UISimulatedMemoryWarningNotification</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CFNotificationCenterPostNotification(CFNotificationCenterGetDarwinNotifyCenter(), (CFStringRef)@&quot;UISimulatedMemoryWarningNotification&quot;, NULL, NULL, true);</div></pre></td></tr></table></figure>
<ul>
<li>ç§æœ‰ API</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[UIApplication sharedApplication] performSelector:@selector(_performMemoryWarning)];</div></pre></td></tr></table></figure>
<h2 id="memory-pressure-observer-on-Mac"><a href="#memory-pressure-observer-on-Mac" class="headerlink" title="memory pressure observer on Mac"></a>memory pressure observer on Mac</h2><p>ç»ˆäºè¦åˆ‡å…¥æ­£é¢˜ï¼ŒæŒ‰ç…§iOSè°ƒç ”çš„èŠ‚å¥å¼€å§‹æŸ¥èµ„æ–™ï½</p>
<h3 id="how-to-observe-1"><a href="#how-to-observe-1" class="headerlink" title="how to observe"></a>how to observe</h3><p>ä»¥ä¸‹æ¥è‡ª <a href="https://github.com/mhuusko5/M5ApplicationMemoryWarning" target="_blank" rel="external">Github</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">static dispatch_source_t source = nil;</div><div class="line">source = dispatch_source_create(DISPATCH_SOURCE_TYPE_MEMORYPRESSURE, 0,  DISPATCH_MEMORYPRESSURE_WARN | DISPATCH_MEMORYPRESSURE_CRITICAL, dispatch_get_main_queue());</div><div class="line"></div><div class="line">dispatch_source_set_event_handler(source, ^&#123;</div><div class="line">dispatch_source_memorypressure_flags_t pressureLevel = dispatch_source_get_data(source);</div><div class="line">[NSNotificationCenter.defaultCenter postNotificationName:DidReceiveMemoryWarningNotification</div><div class="line">object:nil</div><div class="line">userInfo:@&#123; @&quot;pressure&quot;: @(pressureLevel) &#125;];</div><div class="line">&#125;);</div><div class="line"></div><div class="line">dispatch_resume(source);</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ dispatch_source_create çš„è§£é‡Šï¼š</p>
<p>Creates a new dispatch source to monitor low-level system objects and automatically submit a handler block to a dispatch queue in response to events.</p>
<p>å¯ä»¥ç›‘æ§çš„ system objects å¾ˆå¤šï¼ŒåŒ…æ‹¬ Timerï¼ŒSignalï¼Œ MemoryPressure ç­‰ã€‚</p>
<p>å…¶ä¸­ memoryPressure level çš„å®šä¹‰å¦‚ä¸‹ï¼š </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#define DISPATCH_MEMORYPRESSURE_NORMAL		0x01</div><div class="line">#define DISPATCH_MEMORYPRESSURE_WARN		0x02</div><div class="line">#define DISPATCH_MEMORYPRESSURE_CRITICAL	0x04</div></pre></td></tr></table></figure>
<h3 id="how-to-mock-1"><a href="#how-to-mock-1" class="headerlink" title="how to mock"></a>how to mock</h3><p>ç›®å‰æ‰¾åˆ°çš„<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=463604" target="_blank" rel="external">æ–¹æ³•</a>,<br>åœ¨ terminal è¾“å…¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo memory_pressure -S -l critical -s 15</div></pre></td></tr></table></figure>
<p>-S causes the system to simulate the specified memory pressure (warn | critical), and -s tells how many seconds to hold that simulated pressure.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/18/é…ç½®-gitignore/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/18/é…ç½®-gitignore/" itemprop="url">
                  é…ç½®.gitignore
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-04-18T20:38:47+08:00">
                2017-04-18
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/04/18/é…ç½®-gitignore/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/04/18/é…ç½®-gitignore/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="GitHub-å®˜æ–¹"><a href="#GitHub-å®˜æ–¹" class="headerlink" title="GitHub å®˜æ–¹"></a>GitHub å®˜æ–¹</h2><p>GitHub å®˜æ–¹å·²ç»å‡†å¤‡äº†é€‚ç”¨å„ç§è¯­è¨€å’Œå¼€å‘ç¯å¢ƒçš„é…ç½®æ–‡ä»¶ï¼Œ<a href="https://github.com/github/gitignore" target="_blank" rel="external">é“¾æ¥</a>ã€‚é€‰æ‹©ä¸‹è½½å¯¹åº”çš„è¯­è¨€ï¼Œå†ç»“åˆè‡ªå®šä¹‰å°±å¯ä»¥é…ç½®å¥½ç”¨çš„ .ignore å•¦ã€‚</p>
<h2 id="å¿½ç•¥æ–‡ä»¶çš„åŸåˆ™"><a href="#å¿½ç•¥æ–‡ä»¶çš„åŸåˆ™" class="headerlink" title="å¿½ç•¥æ–‡ä»¶çš„åŸåˆ™"></a>å¿½ç•¥æ–‡ä»¶çš„åŸåˆ™</h2><ul>
<li>å¿½ç•¥æ“ä½œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ¯”å¦‚ç¼©ç•¥å›¾ç­‰ï¼›</li>
<li>å¿½ç•¥ç¼–è¯‘ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶ã€å¯æ‰§è¡Œæ–‡ä»¶ç­‰ï¼Œä¹Ÿå°±æ˜¯å¦‚æœä¸€ä¸ªæ–‡ä»¶æ˜¯é€šè¿‡å¦ä¸€ä¸ªæ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œé‚£è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶å°±æ²¡å¿…è¦æ”¾è¿›ç‰ˆæœ¬åº“ï¼›</li>
<li>å¿½ç•¥ä½ è‡ªå·±çš„å¸¦æœ‰æ•æ„Ÿä¿¡æ¯çš„é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚å­˜æ”¾å£ä»¤çš„é…ç½®æ–‡ä»¶ã€‚</li>
</ul>
<h2 id="gitignore-æ–‡ä»¶è§„èŒƒ"><a href="#gitignore-æ–‡ä»¶è§„èŒƒ" class="headerlink" title=".gitignore æ–‡ä»¶è§„èŒƒ"></a>.gitignore æ–‡ä»¶è§„èŒƒ</h2><ol>
<li>æ‰€æœ‰ç©ºè¡Œæˆ–è€…ä»¥æ³¨é‡Šç¬¦å· ï¼ƒ å¼€å¤´çš„è¡Œéƒ½ä¼šè¢« Git å¿½ç•¥ã€‚ </li>
<li>å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ glob æ¨¡å¼åŒ¹é…ã€‚ </li>
<li>åŒ¹é…æ¨¡å¼æœ€åè·Ÿåæ–œæ ï¼ˆ/ï¼‰è¯´æ˜è¦å¿½ç•¥çš„æ˜¯ç›®å½•ã€‚ </li>
<li>è¦å¿½ç•¥æŒ‡å®šæ¨¡å¼ä»¥å¤–çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¯ä»¥åœ¨æ¨¡å¼å‰åŠ ä¸ŠæƒŠå¹å·ï¼ˆ!ï¼‰å–åã€‚</li>
</ol>
<h2 id="glob-æ¨¡å¼"><a href="#glob-æ¨¡å¼" class="headerlink" title="glob æ¨¡å¼"></a>glob æ¨¡å¼</h2><ol>
<li>*:ä»»æ„ä¸ªä»»æ„å­—ç¬¦ã€‚</li>
<li>[]:åŒ¹é…ä»»ä½•ä¸€ä¸ªåœ¨æ–¹æ‹¬å·ä¸­çš„å­—ç¬¦ã€‚</li>
<li>?:åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ã€‚</li>
<li>[0-9]:åŒ¹é…å­—ç¬¦èŒƒå›´å†…æ‰€æœ‰å­—ç¬¦ã€‚</li>
</ol>
<h2 id="é…ç½®-gitignore"><a href="#é…ç½®-gitignore" class="headerlink" title="é…ç½® .gitignore"></a>é…ç½® .gitignore</h2><p>å¯ä»¥åœ¨å¯¹åº”çš„Gitç›®å½•ä¸‹ï¼Œåˆ›å»º.gitignoreæ–‡ä»¶ã€‚åœ¨å¿½ç•¥é¡¹ä¸­åŠ å…¥.DS_Storeã€‚</p>
<ul>
<li>åˆ›å»º .gitignore æ–‡ä»¶</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ touch .gitignore</div></pre></td></tr></table></figure>
<ul>
<li>ç¼–è¾‘ .gitignore æ–‡ä»¶</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ .DS_Store</div><div class="line">$ */.DS_Store</div></pre></td></tr></table></figure>
<p>ä¿å­˜å³å¯ç”Ÿæ•ˆï¼Œç›®å‰å·²å®Œæˆå¿½ç•¥äº†å½“å‰ç›®å½•çš„ .DS_Store ä»¥åŠå…¶å­ç›®å½•çš„ .DS_Storeã€‚ä½†æ˜¯æ€æ ·æ‰èƒ½è¾¾åˆ°å…¨å±€æœ‰æ•ˆå‘¢ï¼Œè¿™é‡Œå°±éœ€è¦å…¨å±€é…ç½®ï¼Œè®©å¿½ç•¥æ–‡ä»¶å¯¹å¤šæœ‰Gitç›®å½•éƒ½ç”Ÿæ•ˆï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°git configã€‚</p>
<h2 id="é…ç½®-Git-Config"><a href="#é…ç½®-Git-Config" class="headerlink" title="é…ç½® Git Config"></a>é…ç½® Git Config</h2><p>Git Configå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä½äºç”¨æˆ·æ ¹ç›®å½•ï¼Œåç§°æ˜¯ .gitconfigã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ touch .gitignore_global</div><div class="line">// ç¼–è¾‘ .gitignore_global æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œå¼•å…¥.gitignore_globalæ–‡ä»¶</div><div class="line">[core]  </div><div class="line">excludesfile = /Users/reon/.gitignore_global</div></pre></td></tr></table></figure>
<p>æŠŠä» GitHub ä¸Šä¸‹è½½çš„è‡ªå®šä¹‰ä¿®æ”¹åçš„ .gitignore æ–‡ä»¶ copy åˆ°è¯¥è·¯å¾„å³å¯ã€‚</p>
<h2 id="æ·»åŠ -gitignore-åä¸ç”Ÿæ•ˆæ€ä¹ˆåŠ"><a href="#æ·»åŠ -gitignore-åä¸ç”Ÿæ•ˆæ€ä¹ˆåŠ" class="headerlink" title="æ·»åŠ  .gitignore åä¸ç”Ÿæ•ˆæ€ä¹ˆåŠ"></a>æ·»åŠ  .gitignore åä¸ç”Ÿæ•ˆæ€ä¹ˆåŠ</h2><ul>
<li>you must pay attention to the global gitignore file which sometimes may influence your gitignore.</li>
<li>When you add something into .gitignore fileã€‚First commit your current changes, or you will lose them.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ git rm -r --cached .</div><div class="line">$ git add .</div><div class="line">$ git commit -m &quot;fixed untracked files&quot;</div></pre></td></tr></table></figure>
<ul>
<li>When you remove something from .gitignore file.The above steps will not work for you. First commit your current changes, or you will lose them.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git add -f &quot;filetype&quot;</div><div class="line">git commit -m &quot;Refresh removing filetype from .gitignore file.&quot;</div><div class="line">// the &quot;filetype&quot; means the file or filetype you want to remove from the .gitignore file. </div><div class="line">// You want to make the filetype be tracked again.</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/11/blockä¸­weakSelfå’ŒstrongSelfè¯¦è§£/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/11/blockä¸­weakSelfå’ŒstrongSelfè¯¦è§£/" itemprop="url">
                  blockä¸­weakSelfå’ŒstrongSelfè¯¦è§£
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-04-11T21:12:52+08:00">
                2017-04-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/04/11/blockä¸­weakSelfå’ŒstrongSelfè¯¦è§£/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/04/11/blockä¸­weakSelfå’ŒstrongSelfè¯¦è§£/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æœ€è¿‘åœ¨çœ‹SDWebImageçš„æºç ï¼Œå…¶ä¸­å¯¹blockä¸­å¾ªç¯å¼•ç”¨é—®é¢˜çš„å¤„ç†å€¼å¾—å­¦ä¹ ã€‚ä¹‹å‰çš„é¡¹ç›®ä¹Ÿé‡åˆ°è¿‡å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œé‚æœ‰å¿…è¦ç ”ç©¶æ€»ç»“ã€‚</p>
<h2 id="å½“blockç›´æ¥æˆ–é—´æ¥çš„è¢«selfæŒæœ‰æ—¶ï¼Œéœ€ç”¨weakSelf"><a href="#å½“blockç›´æ¥æˆ–é—´æ¥çš„è¢«selfæŒæœ‰æ—¶ï¼Œéœ€ç”¨weakSelf" class="headerlink" title="å½“blockç›´æ¥æˆ–é—´æ¥çš„è¢«selfæŒæœ‰æ—¶ï¼Œéœ€ç”¨weakSelf"></a>å½“blockç›´æ¥æˆ–é—´æ¥çš„è¢«selfæŒæœ‰æ—¶ï¼Œéœ€ç”¨weakSelf</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">dispatch_block_t completionBlock = ^&#123; </div><div class="line">// selfæœªæŒæœ‰blockï¼Œå¯ç›´æ¥ç”¨self </div><div class="line">NSLog(@&quot;%@&quot;, self); </div><div class="line">&#125; </div><div class="line">MyViewController *myController = [[MyViewController alloc] init...]; </div><div class="line">[self presentViewController:myController animated:YES completion:completionHandler];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">__weak typeof(self) weakSelf = self;</div><div class="line">self.completionHandler = ^&#123; </div><div class="line">// self æŒæœ‰ blockï¼Œç›´æ¥ç”¨ self æœƒé€ æˆ retain cycle </div><div class="line">NSLog(@&quot;%@&quot;, weakSelf);</div><div class="line">&#125; </div><div class="line">MyViewController *myController = [[MyViewController alloc] init...]; </div><div class="line">[self presentViewController:myController animated:YES completion:self.completionHandler];</div></pre></td></tr></table></figure>
<h2 id="blockä¸­éœ€å¤šæ¬¡è®¿é—®selfï¼Œéœ€ç”¨strongSelf"><a href="#blockä¸­éœ€å¤šæ¬¡è®¿é—®selfï¼Œéœ€ç”¨strongSelf" class="headerlink" title="blockä¸­éœ€å¤šæ¬¡è®¿é—®selfï¼Œéœ€ç”¨strongSelf"></a>blockä¸­éœ€å¤šæ¬¡è®¿é—®selfï¼Œéœ€ç”¨strongSelf</h2><p>åªä½¿ç”¨ weak çš„é—®é¢˜åœ¨äºï¼Œå¦‚æœåœ¨blockä¸­å¿…é¡»å¤šæ¬¡ä½¿ç”¨åˆ°weakSelfä¼šæœ‰å±é™©ã€‚å› ä¸ºåœ¨å¤šæ¬¡æ‰§è¡Œä¸‹ï¼ŒweakSelfæœ‰å¯èƒ½å˜ä¸ºnilã€‚æ‰€ä»¥éœ€è¦ä½¿ç”¨strongSelfï¼Œç¡®ä¿ self çš„æœ‰æ•ˆæ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">__weak typeof(self) weakSelf = self; </div><div class="line">dispatch_block_t block = ^&#123; </div><div class="line">[weakSelf doSomething]; // weakSelf != nil </div><div class="line">// preemption, weakSelf turned nil </div><div class="line">[weakSelf doSomethingElse]; // weakSelf == nil </div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">__weak typeof(self) weakSelf = self;</div><div class="line">myObj.myBlock = ^&#123; </div><div class="line">__strong typeof(weakSelf) strongSelf = weakSelf; </div><div class="line">if (strongSelf) &#123; </div><div class="line">[strongSelf doSomething]; // strongSelf != nil </div><div class="line">// preemption, strongSelf still not nil </div><div class="line">[strongSelf doSomethingElse]; // strongSelf != nil </div><div class="line">&#125; else &#123; </div><div class="line">// Probably nothing... return; </div><div class="line">&#125; </div><div class="line">&#125;;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/04/æ·±å…¥è§£æMac-OSX-iOSæ“ä½œç³»ç»Ÿ-ä¸€/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/04/æ·±å…¥è§£æMac-OSX-iOSæ“ä½œç³»ç»Ÿ-ä¸€/" itemprop="url">
                  æ·±å…¥è§£æMac-OSX-iOSæ“ä½œç³»ç»Ÿ(ä¸€)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-04-04T15:07:30+08:00">
                2017-04-04
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/04/04/æ·±å…¥è§£æMac-OSX-iOSæ“ä½œç³»ç»Ÿ-ä¸€/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/04/04/æ·±å…¥è§£æMac-OSX-iOSæ“ä½œç³»ç»Ÿ-ä¸€/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ç¬¬ä¸€ç« -è¾¾å°”æ–‡ä¸»ä¹‰ï¼šOS-Xçš„è¿›åŒ–å²"><a href="#ç¬¬ä¸€ç« -è¾¾å°”æ–‡ä¸»ä¹‰ï¼šOS-Xçš„è¿›åŒ–å²" class="headerlink" title="ç¬¬ä¸€ç«  è¾¾å°”æ–‡ä¸»ä¹‰ï¼šOS Xçš„è¿›åŒ–å²"></a>ç¬¬ä¸€ç«  è¾¾å°”æ–‡ä¸»ä¹‰ï¼šOS Xçš„è¿›åŒ–å²</h2><h3 id="iOSå’ŒOS-Xå¯¹æ¯”"><a href="#iOSå’ŒOS-Xå¯¹æ¯”" class="headerlink" title="iOSå’ŒOS Xå¯¹æ¯”"></a>iOSå’ŒOS Xå¯¹æ¯”</h3><ul>
<li>iOSå†…æ ¸å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ç¼–è¯‘çš„ç›®æ ‡æ¶æ„æ˜¯åŸºäºARMçš„æ¶æ„ï¼Œè€Œä¸æ˜¯x86ã€‚</li>
<li>iOSçš„å†…æ ¸æºç ä¾ç„¶é—­æºã€‚</li>
<li>iOSå†…æ ¸çš„ç¼–è¯‘ç¨æœ‰ä¸åŒï¼Œå…³æ³¨çš„æ˜¯åµŒå…¥å¼ç‰¹æ€§å’Œä¸€äº›æ–°çš„APIã€‚</li>
<li>iOSçš„ç³»ç»ŸGUIæ˜¯SpringBoardï¼Œè§¦å±åº”ç”¨åŠ è½½å™¨ï¼›è€ŒOS Xä¸­çš„GUIæ˜¯Aquaï¼Œé¼ æ ‡é©±åŠ¨ï¼Œä¸ºçª—å£ç³»ç»Ÿè®¾è®¡ï¼ŒLionä¸­ä»¥LaunchPadçš„å½¢å¼ç§»æ¤äº†SpringBoardã€‚</li>
<li>iOSçš„å†…å­˜ç®¡ç†æ›´ä¸ºä¸¥æ ¼ã€‚</li>
<li>ç³»ç»Ÿçš„é™åˆ¶æ›´ä¸¥æ ¼ã€‚</li>
</ul>
<h2 id="ç¬¬äºŒç« -åˆä¼—ä¸ºä¸€ï¼šOS-Xå’ŒiOSçš„æ¶æ„"><a href="#ç¬¬äºŒç« -åˆä¼—ä¸ºä¸€ï¼šOS-Xå’ŒiOSçš„æ¶æ„" class="headerlink" title="ç¬¬äºŒç«  åˆä¼—ä¸ºä¸€ï¼šOS Xå’ŒiOSçš„æ¶æ„"></a>ç¬¬äºŒç«  åˆä¼—ä¸ºä¸€ï¼šOS Xå’ŒiOSçš„æ¶æ„</h2><h3 id="2-1-OS-Xæ¶æ„æ¦‚è¿°"><a href="#2-1-OS-Xæ¶æ„æ¦‚è¿°" class="headerlink" title="2.1 OS Xæ¶æ„æ¦‚è¿°"></a>2.1 OS Xæ¶æ„æ¦‚è¿°</h3><ul>
<li>ç”¨æˆ·ä½“éªŒå±‚</li>
<li>åº”ç”¨æ¡†æ¶å±‚</li>
<li>æ ¸å¿ƒæ¡†æ¶å±‚</li>
<li>Darwin</li>
</ul>
<h3 id="2-2-ç”¨æˆ·ä½“éªŒå±‚"><a href="#2-2-ç”¨æˆ·ä½“éªŒå±‚" class="headerlink" title="2.2 ç”¨æˆ·ä½“éªŒå±‚"></a>2.2 ç”¨æˆ·ä½“éªŒå±‚</h3><p>æä¾›ç”¨æˆ·ç•Œé¢<br>OS Xç”¨æˆ·ä½“éªŒå±‚ä¸­çš„ç»„ä»¶ï¼š</p>
<ul>
<li>Aqua</li>
<li>Quick Look</li>
<li>Spotlight</li>
<li>Accessibility</li>
</ul>
<p>iOSçš„æ¶æ„åœ¨ç”¨æˆ·ä½“éªŒå±‚ä¹‹ä¸‹åŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯åœ¨ç”¨æˆ·ä½“éªŒå±‚å¾ˆå¤§åŒºåˆ«ã€‚SpringBoardå®Œå…¨è´Ÿè´£æ‰€æœ‰çš„ç”¨æˆ·ç•Œé¢çš„ä»»åŠ¡ã€‚</p>
<h4 id="Aqua"><a href="#Aqua" class="headerlink" title="Aqua"></a>Aqua</h4><p>Aquaæ˜¯OS Xçš„GUIã€‚ä¸»è¦ä»‹ç»Aquaä»»ä½•æ”¯æŒGUIçš„ç›¸å…³ç‰¹æ€§ã€‚<br>ç³»ç»Ÿçš„ç¬¬ä¸€ä¸ªç”¨æˆ·æ€è¿›ç¨‹launchdè´Ÿè´£å¯åŠ¨GUIã€‚æ”¯æŒGUIå·¥ä½œçš„ä¸»è¿›ç¨‹æ˜¯WindowServerï¼Œä¸”WindowServeræ˜¯Core Graphicsæ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œè€ŒCore Graphicsä½äºå¦ä¸€ä¸ªæ¡†æ¶Application Servicesä¸­ã€‚å› æ­¤ï¼ŒWindowServerçš„è·¯å¾„æ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/System/Libary/Frameworks/ApplicationServices.framework/Frameworks/CoreGraphic.framework/Resources/WindowServer</div></pre></td></tr></table></figure>
<p>WindowServerå¯åŠ¨æ—¶ä¼ å…¥ -daemon å¼€å…³å‚æ•°ã€‚WindowServerçš„ä»£ç å®é™…ä¸Šä¸å®Œæˆä»»ä½•å®é™…çš„å·¥ä½œï¼Œæ‰€æœ‰çš„å·¥ä½œéƒ½æ˜¯CoreGraphicsæ¡†æ¶ä¸­çš„CGXServerå‡½æ•°å®Œæˆçš„ã€‚</p>
<p>CGXServerä¼šæ£€æŸ¥è‡ªå·±æ˜¯å¦ä»¥åå°æœåŠ¡ç¨‹åºæˆ–è€…ä»¥ä¸»æ§åˆ¶å°gettyçš„æ–¹å¼è¿è¡Œã€‚ç„¶ååœ¨åå°forkå‡ºè‡ªå·±çš„å­è¿›ç¨‹ã€‚å½“å­è¿›ç¨‹å‡†å¤‡å¥½ä¹‹åï¼ŒLoginWindowè¿›ç¨‹ï¼ˆåŒæ ·ç”±launchdå¯åŠ¨çš„ï¼‰å¯åŠ¨äº¤äº’å¼ç™»å½•è¿‡ç¨‹ã€‚</p>
<h4 id="QuickLook"><a href="#QuickLook" class="headerlink" title="QuickLook"></a>QuickLook</h4><p>QuickLookå…è®¸åœ¨Finderä¸­å¿«é€Ÿé¢„è§ˆå¤šç§ä¸åŒç±»å‹çš„æ–‡ä»¶ï¼Œä¸éœ€è¦åŒå‡»é¼ æ ‡æ‰“å¼€æ–‡ä»¶ï¼Œåªéœ€è¦æŒ‰ä¸‹ç©ºæ ¼å³å¯ã€‚</p>
<p>QuickLooké‡‡ç”¨çš„æ˜¯å¯æ‰©å±•çš„æ¶æ„ï¼Œä½¿å¾—å¤§éƒ¨åˆ†å·¥ä½œæ˜¯ç”±æ’ä»¶å®Œæˆã€‚è¿™äº›æ’ä»¶æ˜¯åç¼€ä¸º .qlgenerator çš„bundleï¼Œåªéœ€è¦å°†è¿™äº›bundleæ–‡ä»¶æ‹–æ”¾åˆ°QuickLookç›®å½•ï¼ˆç³»ç»ŸèŒƒå›´çš„QuickLookç›®å½•ä¸ºï¼systemï¼Libraryï¼QuickLookï¼Œé’ˆå¯¹ä¸ªäººçš„èƒƒï½ï¼Libarayï¼QuickLookï¼‰ä¸­å³å¯å®Œæˆæ’ä»¶çš„å®‰è£…ã€‚</p>
<p>æ’ä»¶ä¸æ˜¯ç‹¬ç«‹å¯æ‰§è¡Œç¨‹åºï¼Œæ²¡æœ‰ä¼ ç»Ÿçš„main()å…¥å£ç‚¹ï¼Œè€Œæ˜¯å®ç°äº†QuickLookGeneratorPluginFactoryå…¥å£ç‚¹ã€‚å¦å¤–æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ è´Ÿè´£å°†æ’ä»¶å’Œå¯¹åº”çš„æ–‡ä»¶ç±»å‹å…³è”èµ·æ¥ã€‚æ–‡ä»¶ç±»å‹é€šè¿‡UITè¡¨ç¤ºï¼Œå³é€†DNSè¡¨ç¤ºæ³•ã€‚</p>
<p>quicklookdæ˜¯ç³»ç»Ÿçš„â€QuickLookæœåŠ¡å™¨â€ï¼Œæ˜¯é€šè¿‡ä»¥ä¸‹æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/System/Library/LaunchAgents/com.apple.quicklook.plist</div></pre></td></tr></table></figure>
<p>åœ¨ç™»å½•æ—¶å¯åŠ¨çš„ã€‚è¿™ä¸ªåå°æœåŠ¡ç¨‹åºæœ¬èº«åœ¨QuickLookæ¡†æ¶ä¸­ï¼Œè€Œä¸”ä¸å¸¦GUIã€‚</p>
<p>qlmanageå‘½ä»¤çš„ä½œç”¨æ˜¯ç»´æŠ¤æ’ä»¶ï¼Œå¹¶ä¸”æ§åˆ¶åå°æœåŠ¡ç¨‹åºã€‚</p>
<h4 id="Spotlight"><a href="#Spotlight" class="headerlink" title="Spotlight"></a>Spotlight</h4><p>spotlightèƒŒåçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªç´¢å¼•æœåŠ¡å™¨mdsï¼Œmdsåœ¨MetaDataæ¡†æ¶ä¸­ï¼Œè€Œè¿™ä¸ªæ¡†æ¶æ˜¯ç³»ç»Ÿæ ¸å¿ƒæœåŠ¡çš„ä¸€éƒ¨åˆ†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ï¼Systemï¼Library/CoreServices.frmework/Frameworks/Metadata.framework/Suppot/mds</div></pre></td></tr></table></figure>
<p>mdsæ˜¯ä¸€ä¸ªæ²¡æœ‰GUIçš„åå°æœåŠ¡ç¨‹åºã€‚æ¯å½“æœ‰ä»»ä½•æ–‡ä»¶æ“ä½œï¼ˆåˆ›å»ºï¼ä¿®æ”¹ï¼åˆ é™¤ï¼‰å‘ç”Ÿæ—¶ï¼Œå†…æ ¸ä¼šå‘é€é€šçŸ¥çµ¦mdsï¼Œè¿™ä¸ªé€šçŸ¥æœºåˆ¶ç§°ä¸ºfseventsã€‚</p>
<p>å½“mdsæ”¶åˆ°é€šçŸ¥æ—¶ï¼Œmdsä¼šé€šè¿‡mdworkerè¿›ç¨‹å°†å„ç§å…ƒæ•°æ®ä¿¡æ¯å¯¼å…¥æ•°æ®åº“ã€‚mdworkerè¿›ç¨‹å¯ä»¥åŠ è½½ä¸€ä¸ªå…·ä½“çš„Spotlight Importerä»æ–‡ä»¶ä¸­æå–å…ƒæ•°æ®ä¿¡æ¯ã€‚</p>
<p>å¯¼å…¥å™¨è·¯å¾„ï¼ˆç³»ç»Ÿï¼š/system/Library/Spotlight   ç”¨æˆ·ï¼š/Library/Spotlightï¼‰ï¼Œå’ŒQuickLookç±»ä¼¼ï¼Œè¿™äº›importeræ˜¯å®ç°äº†å›ºå®šAPIçš„æ’ä»¶ã€‚</p>
<h3 id="2-3-Darwin-UNIXæ ¸å¿ƒ"><a href="#2-3-Darwin-UNIXæ ¸å¿ƒ" class="headerlink" title="2.3 Darwin-UNIXæ ¸å¿ƒ"></a>2.3 Darwin-UNIXæ ¸å¿ƒ</h3><p>OS Xä¸­çš„Darwinæ˜¯ä¸€ä¸ªå®Œå…¨æˆç†Ÿçš„UNIXå®ç°ã€‚</p>
<h4 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h4><p>Terminalé»˜è®¤æ‰“å¼€çš„shellæ˜¯/bin/bash</p>
<p>OS Xå’ŒiOSä¸­çš„å‘½ä»¤è¡Œå·¥å…·è¿˜å¯ä»¥é€šè¿‡telnetå’ŒSSHè¿œç¨‹è®¿é—®ã€‚OS Xå’ŒiOSé»˜è®¤ç¦æ­¢ï¼ŒOS Xæ‰“å¼€æ–¹å¼å¦‚ä¸‹ï¼ŒiOSéœ€è¦jailbreakã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo bash</div><div class="line">/System/Library/LaunchDaemons/telnet.plist</div><div class="line">/System/Library/LaunchDaemons/ssh.plist</div><div class="line">key:Disabled -&gt;NO</div></pre></td></tr></table></figure>
<h4 id="æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿ"></a>æ–‡ä»¶ç³»ç»Ÿ</h4><p>OS Xå’ŒiOSé‡‡ç”¨çš„éƒ½æ˜¯HFS+çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒHFS+æ€»æ˜¯ä¿å­˜å¤§å°å†™çš„åŒºåˆ«ã€‚<br>iOSé‡‡ç”¨HFSXï¼Œé»˜è®¤å¯¹å¤§å°å†™æ•æ„Ÿã€‚OS Xåˆ™æœªé‡‡ç”¨ã€‚</p>
<h3 id="UNIXçš„ç³»ç»Ÿç›®å½•"><a href="#UNIXçš„ç³»ç»Ÿç›®å½•" class="headerlink" title="UNIXçš„ç³»ç»Ÿç›®å½•"></a>UNIXçš„ç³»ç»Ÿç›®å½•</h3><p>OS Xæ˜¯ç¬¦åˆUNIXæ ‡å‡†çš„ç³»ç»Ÿï¼Œå…·æœ‰æ ‡å‡†çš„UNIXç›®å½•ç»“æ„ï¼š</p>
<ul>
<li>/binï¼šUNIXä¸­çš„äºŒè¿›åˆ¶ç¨‹åºï¼Œå¸¸ç”¨UNIXå‘½ä»¤æ‰€åœ¨ã€‚</li>
<li>/sbinï¼šç³»ç»Ÿç¨‹åº</li>
<li>ï¼usr: Userç›®å½•ã€‚ç¬¬ä¸‰æ–¹çš„è½¯ä»¶å®‰è£…åœ¨è¿™é‡Œã€‚ç›®å½•ä¸­åŒ…å« binï¼sbinï¼libã€‚libç”¨äºå­˜æ”¾å…±äº«çš„ç›®æ ‡æ–‡ä»¶ã€‚</li>
<li>ï¼etcï¼šç³»ç»Ÿé…ç½®æ–‡ä»¶ã€‚</li>
<li>ï¼devï¼šBSDè®¾å¤‡æ–‡ä»¶ã€‚</li>
<li>ï¼tmpï¼šOS Xä¸ŠæŒ‡å‘ï¼privateï¼tmpï¼Œç³»ç»Ÿä¸Šå”¯ä¸€æ‰€æœ‰äººéƒ½æœ‰å¯å†™æƒé™çš„ç›®å½•ã€‚</li>
<li>ï¼varï¼šOS Xä¸ŠæŒ‡å‘ï¼privateï¼varï¼Œå­˜å‚¨æ‚é¡¹æ–‡ä»¶ï¼Œæ—¥å¿—ï¼Œæ‰“å°é˜Ÿåˆ—ï¼Œé‚®ä»¶å­˜å‚¨ç­‰ã€‚</li>
</ul>
<h4 id="OS-Xç‰¹æœ‰çš„ç›®å½•"><a href="#OS-Xç‰¹æœ‰çš„ç›®å½•" class="headerlink" title="OS Xç‰¹æœ‰çš„ç›®å½•"></a>OS Xç‰¹æœ‰çš„ç›®å½•</h4><ul>
<li>ï¼Applicationsï¼šç³»ç»Ÿä¸­æ‰€æœ‰åº”ç”¨ç¨‹åºçš„é»˜è®¤ç›®å½•</li>
<li>ï¼Developerï¼šæ‰€æœ‰å¼€å‘è€…å·¥å…·çš„é»˜è®¤å®‰è£…ä½ç½®</li>
<li>/Libary: ç³»ç»Ÿåº”ç”¨çš„æ•°æ®æ–‡ä»¶ï¼å¸®åŠ©å’Œæ–‡æ¡£ç­‰æ•°æ®éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ã€‚</li>
<li>ï¼Networkï¼šç”¨äºé‚»å±…èŠ‚ç‚¹å‘ç°å’Œè®¿é—®çš„è™šæ‹Ÿç›®å½•ã€‚</li>
<li>ï¼Systemï¼šç³»ç»Ÿæ–‡ä»¶ç›®å½•ã€‚å…¶ä¸­åªåŒ…å«ä¸€ä¸ªLibraryå­ç›®å½•ï¼Œå‡ ä¹åŒ…å«äº†ç³»ç»Ÿä¸­çš„æ‰€æœ‰é‡è¦çš„ç»„ä»¶ã€‚</li>
<li>ï¼Usersï¼šæ‰€æœ‰ç”¨æˆ·çš„ä¸»ç›®å½•æ‰€åœ¨çš„ç›®å½•ã€‚æ¯ä¸€ä¸ªç”¨æˆ·åœ¨è¿™é‡Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªè‡ªå·±çš„ç›®å½•ã€‚</li>
<li>ï¼Volumesï¼šå¯ç§»åŠ¨åª’ä½“å’Œç½‘ç»œæ–‡ä»¶ç³»ç»Ÿçš„mountç‚¹æ‰€åœ¨ç›®å½•</li>
<li>ï¼Coresï¼šå¦‚æœå¯åŠ¨äº†core dumpï¼Œé‚£ä¹ˆåˆæ ¼ç›®å½•ä¿å­˜core dumpæ–‡ä»¶ã€‚ç¬¬å››ç« è¯¦ç»†è®¨è®ºã€‚</li>
</ul>
<h4 id="iOSæ–‡ä»¶ç³»ç»Ÿçš„åŒºåˆ«"><a href="#iOSæ–‡ä»¶ç³»ç»Ÿçš„åŒºåˆ«" class="headerlink" title="iOSæ–‡ä»¶ç³»ç»Ÿçš„åŒºåˆ«"></a>iOSæ–‡ä»¶ç³»ç»Ÿçš„åŒºåˆ«</h4><ul>
<li>HFSXå¤§å°å†™æ•æ„Ÿï¼Œä¸”æ–‡ä»¶ç³»ç»Ÿæ˜¯éƒ¨åˆ†åŠ å¯†çš„ã€‚<br>// TODO è¿™é‡Œåç»­æœ‰äº†æ›´å¤šäº†è§£å†è¡¥å……</li>
</ul>
<h3 id="bundle"><a href="#bundle" class="headerlink" title="bundle"></a>bundle</h3><p>æ¯ä¸€ä¸ªbundleéƒ½å¸¦æœ‰ç›¸åŒçš„ç›®å½•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Contents/</div><div class="line">CodeResources/</div><div class="line">Info.plist</div><div class="line">MacOS/  åŒ…ä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶å†…å®¹</div><div class="line">PkgInfo    åŒ…çš„8å­—èŠ‚æ ‡è¯†ç¬¦</div><div class="line">Resources/</div><div class="line">Version.plist</div><div class="line">CodeSignature/</div></pre></td></tr></table></figure>
<h3 id="åº”ç”¨ç¨‹åºå’ŒApp"><a href="#åº”ç”¨ç¨‹åºå’ŒApp" class="headerlink" title="åº”ç”¨ç¨‹åºå’ŒApp"></a>åº”ç”¨ç¨‹åºå’ŒApp</h3><p>OS Xå¯¹åº”ç”¨ç¨‹åºçš„å¤„ç†æ–¹å¼æ˜¯è¾ƒä¸ºæ•´æ´åœ°åŒ…è£…åœ¨bundleä¸­ï¼Œåº”ç”¨ç¨‹åºçš„bundleåŒ…å«è¿è¡Œè¿™ä¸ªåº”ç”¨ç¨‹åºæ‰€éœ€è¦çš„å¤§éƒ¨åˆ†æ–‡ä»¶ã€‚</p>
<p>åœ¨iOSä¸­ï¼Œappçš„ç»“æ„æ²¡æœ‰è¿™ä¹ˆæ•´æ´ã€‚iOSä¼šåŒºåˆ†è‹¹æœæä¾›çš„é»˜è®¤çš„åº”ç”¨ç¨‹åºï¼ˆï¼Applicationç›®å½•ä¸‹ï¼‰ï¼Œè¶Šç‹±æƒ…å†µå’Œé€šè¿‡App storeè´­ä¹°çš„appï¼ˆï¼varï¼mobileï¼Applicationç›®å½•ä¸‹ï¼‰ã€‚<br>é€šè¿‡Storeè´­ä¹°çš„appå®‰è£…åœ¨ä¸€ä¸ªè¡¨ç¤º128ä½GUIDçš„ç›®å½•ä¸‹ã€‚</p>
<p>å½“iOS appåœ¨è¿è¡Œæ—¶ï¼Œä¼šè¢«chrootåˆ°è‡ªå·±çš„åº”ç”¨ç›®å½•ï¼Œå³åå­—ä¸ºGUIDçš„ç›®å½•ï¼Œåº”ç”¨ç¨‹åºå°†è‡ªå·±GUIDåå­—çš„ç›®å½•å½“ä½œæ ¹ç›®å½•ï¼Œå› æ­¤ï¼tmpæŒ‡å‘çš„æ˜¯GUIDï¼tmpã€‚</p>
<p>ä»storeè´­ä¹°åº”ç”¨æ—¶ï¼Œåº”ç”¨ä»¥.ipaæ–‡ä»¶çš„å½¢å¼æ‰“åŒ…ï¼Œè¿™ç§æ–‡ä»¶å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ª.zipæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åœ¨Payloadï¼ç›®å½•ä¸‹å‹ç¼©äº†åº”ç”¨ç¨‹åºçš„ç›®å½•å†…å®¹ã€‚</p>
<h4 id="info-plist"><a href="#info-plist" class="headerlink" title="info.plist"></a>info.plist</h4><p>ä¸€ä¸ªæ ‡å‡†çš„infoã€‚plistæ–‡ä»¶åŒ…å«ä»¥ä¸‹æ¡ç›®ï¼š</p>
<ul>
<li>CFBundleDevelopmentRegion:é»˜è®¤è¯­è¨€</li>
<li>CFBundledisplayName:æ˜¾ç¤ºçµ¦ç”¨æˆ·çš„bundleåç§°</li>
<li>CFBundleDocumentTypeï¼šbundleå…³è”çš„æ–‡ä»¶ç±»å‹ã€‚æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒvalueæŒ‡å®šäº†bundleèƒ½å¤Ÿå¤„ç†çš„æ–‡ä»¶æ‰©å±•åã€‚è¿˜æŒ‡å®šäº†å…³è”æ–‡æ¡£æ˜¾ç¤ºçš„å›¾æ ‡ã€‚</li>
<li>CFBundleExecutableï¼šå®é™…çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½äºContentsï¼MacOSç›®å½•ã€‚</li>
<li>CFBundlePackageTypeï¼šè¡¨ç¤ºä¸€ä¸ª4å­—æ¯çš„ä»£ç ï¼Œä¾‹å¦‚APPL = Applicationï¼ŒFRMW = Frameworkï¼Œ BNDL = Bundleã€‚</li>
<li>CFBundleURLTypesï¼šè¿™ä¸ªbundleå…³è”çš„URLã€‚æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒvalueæŒ‡å®šäº†è¿™ä¸ªbundleå¤„ç†çš„URL schemeä»¥åŠå¤„ç†æ–¹å¼ã€‚</li>
</ul>
<h4 id="CodeResources"><a href="#CodeResources" class="headerlink" title="CodeResources"></a>CodeResources</h4><p>CodeResourceså®é™…ä¸Šæ˜¯ä¸€ä¸ªæŒ‡å‘_CodeSignature/CodeResourcesçš„é“¾æ¥ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªå±æ€§åˆ—è¡¨ï¼ŒåŒ…å«bundleä¸­æ‰€æœ‰å…¶ä»–æ–‡ä»¶çš„åˆ—è¡¨ã€‚è¿™ä¸ªå±æ€§åˆ—è¡¨åªæœ‰ä¸€é¡¹filesï¼Œæ˜¯å­—å…¸ã€‚keyå¯¹åº”æ–‡ä»¶åï¼Œvalueæ˜¯Base64æ ¼å¼çš„æ•£åˆ—å€¼ã€‚<br>CodeResourcesæ–‡ä»¶å¯ä»¥ç”¨ä¸åˆ¤æ–­ä¸€ä¸ªåº”ç”¨ç¨‹åºæ˜¯å¦å®Œå¥½æ— æŸï¼Œèƒ½å¤Ÿé˜²æ­¢ä¸å°å¿ƒä¿®æ”¹æˆ–æŸåèµ„æºæ–‡ä»¶ã€‚</p>
<h3 id="æ¡†æ¶"><a href="#æ¡†æ¶" class="headerlink" title="æ¡†æ¶"></a>æ¡†æ¶</h3><p>framework bundleå’Œapp bundleçš„ä¸åŒï¼šå†…å»ºçš„ç‰ˆæœ¬åŒ–æœºåˆ¶ï¼šæ¡†æ¶å¯ä»¥åŒ…å«å¤šä¸ªç‰ˆæœ¬çš„ä»£ç ï¼Œä¸åŒç‰ˆæœ¬å¹¶æ’æ”¾åœ¨ä¸åŒçš„å­ç›®å½•ä¸­ã€‚</p>
<h4 id="æŸ¥æ‰¾æ¡†æ¶"><a href="#æŸ¥æ‰¾æ¡†æ¶" class="headerlink" title="æŸ¥æ‰¾æ¡†æ¶"></a>æŸ¥æ‰¾æ¡†æ¶</h4><ul>
<li>ï¼System/Libary/Frameworks åŒ…å«è‹¹æœæä¾›çš„æ¡†æ¶</li>
<li>/network/libary/frameworks </li>
<li>ï¼Library/Frameworks ä¿å­˜ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼ˆiOSä¸Šä¸ºç©ºï¼‰</li>
<li>~/Library/Frameworks ä¿å­˜ç”¨æˆ·æä¾›çš„æ¡†æ¶</li>
<li>/System/Library/Private/Framworks ç§æœ‰æ¡†æ¶</li>
</ul>
<h4 id="é¡¶å±‚æ¡†æ¶"><a href="#é¡¶å±‚æ¡†æ¶" class="headerlink" title="é¡¶å±‚æ¡†æ¶"></a>é¡¶å±‚æ¡†æ¶</h4><ul>
<li>Carbon</li>
<li>Cocoa</li>
</ul>
<p>Cocoaæ¡†æ¶åŒ…å«äº†å…¶ä»–3ä¸ªæ¡†æ¶ï¼šAppKitï¼ŒCoreDataå’ŒFoudationã€‚å°è£…äº†å…¶ä»–æ¡†æ¶çš„æ¡†æ¶é€šå¸¸ç§°ä¸º ä¿æŠ¤ä¼æ¡†æ¶ï¼ˆumbrella frameworkï¼‰.</p>
<p>// TODO æœ¬ç« è¿˜æœ‰äº›åç»­å†…å®¹ï¼Œæ›´ä¸ºåº•å±‚ï¼Œä»¥åäº†è§£æ›´æ·±æ—¶è¿‡æ¥äº¤ä½œä¸šï½</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/19/TensorFlow-äºŒ-TensorFlow-iOS-Examples/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="melody5417">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="melody5417">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/19/TensorFlow-äºŒ-TensorFlow-iOS-Examples/" itemprop="url">
                  TensorFlow (äºŒ) - TensorFlow iOS Examples
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-03-19T19:02:48+08:00">
                2017-03-19
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/03/19/TensorFlow-äºŒ-TensorFlow-iOS-Examples/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/03/19/TensorFlow-äºŒ-TensorFlow-iOS-Examples/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="TensorFlow-äºŒ-TensorFlow-iOS-Examples"><a href="#TensorFlow-äºŒ-TensorFlow-iOS-Examples" class="headerlink" title="TensorFlow (äºŒ) - TensorFlow iOS Examples"></a>TensorFlow (äºŒ) - TensorFlow iOS Examples</h1><h2 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h2><p>ç¼–è¯‘å¯å‚è€ƒ TF çš„ ios_examples çš„ <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/ios_examples/README.md" target="_blank" rel="external">ReadMe</a> ã€‚</p>
<ul>
<li>å‡çº§ Xcode åˆ° 7.3 ç‰ˆæœ¬åŠæ›´é«˜</li>
<li>å®‰è£…å‘½ä»¤è¡Œå·¥å…·ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ xcode-select --install</div></pre></td></tr></table></figure>
<ul>
<li>å®‰è£… Homebrew, automake, libtool</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ /usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</div><div class="line">$ brew install automake</div><div class="line">$ brew install libtool</div></pre></td></tr></table></figure>
<ul>
<li>æ‰§è¡Œ tensorflow/contrib/makefile è·¯å¾„ä¸‹çš„ build_all_ios.sh è„šæœ¬ï¼Œç¼–è¯‘å¤§æ¦‚ä¸€ä¸ªåŠå°æ—¶ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd tensorflow/contrib/makefile</div><div class="line">$ ./build_all_ios.sh</div></pre></td></tr></table></figure>
<p>æ‰§è¡ŒæˆåŠŸååœ¨ makefile/gen/lib ä¸‹ç”Ÿæˆ libtensorflow-core.a åº“ã€‚</p>
<h2 id="Run-Examples"><a href="#Run-Examples" class="headerlink" title="Run Examples"></a>Run Examples</h2><p>æ­¤æ—¶è¿˜å·®ä¸€æ­¥å³å¯è¿è¡Œ TF æä¾›çš„Demoï¼šæ·»åŠ æ•°æ®æ¨¡å‹ã€‚</p>
<p>æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œæˆ–è€…å¯ä»¥æ‰‹åŠ¨ä¸‹è½½ <a href="https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip" target="_blank" rel="external">Inception</a>ã€‚ç„¶åcopyåˆ°ç›¸åº”è·¯å¾„ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ mkdir -p ~/graphs</div><div class="line">$ curl -o ~/graphs/inception5h.zip \</div><div class="line">https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip \</div><div class="line">&amp;&amp; unzip ~/graphs/inception5h.zip -d ~/graphs/inception5h</div><div class="line">$ cp ~/graphs/inception5h/* tensorflow/contrib/ios_examples/benchmark/data/</div><div class="line">$ cp ~/graphs/inception5h/* tensorflow/contrib/ios_examples/camera/data/</div><div class="line">$ cp ~/graphs/inception5h/* tensorflow/contrib/ios_examples/simple/data/</div></pre></td></tr></table></figure>
<p>ç°åœ¨å¯ä»¥è¿è¡Œä¸‰ä¸ªå®ä¾‹å·¥ç¨‹å•¦ï½</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="melody5417" />
          <p class="site-author-name" itemprop="name">melody5417</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">melody5417</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"melody5417"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  













  
  

  

  

  

  


  

</body>
</html>
